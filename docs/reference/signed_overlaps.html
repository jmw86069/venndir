<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Signed overlaps — signed_overlaps • venndir</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Signed overlaps — signed_overlaps"><meta name="description" content="Calculate signed, directional overlaps across sets"><meta property="og:description" content="Calculate signed, directional overlaps across sets"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">venndir</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.51.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/venndir_gene_expression.html">Venndir with Gene Expression Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmw86069/venndir/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Signed overlaps</h1>
      <small class="dont-index">Source: <a href="https://github.com/jmw86069/venndir/blob/HEAD/R/venndir-overlap.R" class="external-link"><code>R/venndir-overlap.R</code></a></small>
      <div class="d-none name"><code>signed_overlaps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate signed, directional overlaps across sets</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">signed_overlaps</span><span class="op">(</span></span>
<span>  <span class="va">setlist</span>,</span>
<span>  overlap_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"detect"</span>, <span class="st">"each"</span>, <span class="st">"overlap"</span>, <span class="st">"concordance"</span>, <span class="st">"agreement"</span><span class="op">)</span>,</span>
<span>  return_items <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_item_labels <span class="op">=</span> <span class="va">return_items</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"&amp;"</span>,</span>
<span>  trim_label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_blanks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep_item_order <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-setlist">setlist<a class="anchor" aria-label="anchor" href="#arg-setlist"></a></dt>
<dd><p><code>list</code> of named vectors, whose names represent
set items, and whose values represent direction using
values <code>c(-1, 0, 1)</code>.</p></dd>


<dt id="arg-overlap-type">overlap_type<a class="anchor" aria-label="anchor" href="#arg-overlap-type"></a></dt>
<dd><p><code>character</code> value indicating the type of
overlap logic:</p><ul><li><p><code>"each"</code> records each combination of signs;</p></li>
<li><p><code>"overlap"</code> disregards the sign and returns any match
item overlap;</p></li>
<li><p><code>"concordance"</code> represents counts for full
agreement, or <code>"mixed"</code> for any inconsistent overlapping
direction;</p></li>
<li><p><code>"agreement"</code> represents full agreement in direction
as <code>"agreement"</code>, and <code>"mixed"</code> for any inconsistent
direction.</p></li>
</ul></dd>


<dt id="arg-return-items">return_items<a class="anchor" aria-label="anchor" href="#arg-return-items"></a></dt>
<dd><p><code>logical</code> indicating whether to return
the items within each overlap set.</p></dd>


<dt id="arg-return-item-labels">return_item_labels<a class="anchor" aria-label="anchor" href="#arg-return-item-labels"></a></dt>
<dd><p><code>logical</code> indicating whether to return
the directional label associated with each item. A directional
label combines the direction from <code>setlist</code> by item.</p></dd>


<dt id="arg-sep">sep<a class="anchor" aria-label="anchor" href="#arg-sep"></a></dt>
<dd><p><code>character</code> used as a delimiter between set names,
the default is <code>"&amp;"</code>.</p></dd>


<dt id="arg-trim-label">trim_label<a class="anchor" aria-label="anchor" href="#arg-trim-label"></a></dt>
<dd><p><code>logical</code> indicating whether to trim the
directional label, for example instead of returning <code>"0 1 -1"</code>
it will return <code>"1 -1"</code> because the overlap name already
indicates the sets involved.</p></dd>


<dt id="arg-include-blanks">include_blanks<a class="anchor" aria-label="anchor" href="#arg-include-blanks"></a></dt>
<dd><p><code>logical</code> indicating whether each set overlap
should be represented at least once even when no items are
present in the overlap. When <code>include_blanks=TRUE</code> is useful
in that it guarantees all possible combinations of overlaps
are represented consistently in the output.</p></dd>


<dt id="arg-keep-item-order">keep_item_order<a class="anchor" aria-label="anchor" href="#arg-keep-item-order"></a></dt>
<dd><p><code>logical</code> default FALSE, to determine whether
items will be stored and displayed in the order they are provided.
Note: <code>keep_item_order=TRUE</code> enables the following behaviors:</p><ul><li><p>Any <code>character</code> vector input will retain the order they appear.</p></li>
<li><p>Any <code>factor</code> vector input will sort items using factor <code>levels</code>,
which maintains the factor level order.</p></li>
<li><p>Any named vector will use the <code>character</code> vector of names, keeping
the order they appear in the vector.</p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p><code>logical</code> default FALSE, whether to print warnings during
import in the event that input data is coerced to another type.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are passed to <code>list2imsigned()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>data.frame</code> with columns intended to support <code><a href="venndir.html">venndir()</a></code>,
but which may be more widely useful:</p><ul><li><p><code>"sets"</code> - character vector with sets and overlap names.</p></li>
<li><p>one column indicating the <code>overlap_type</code> and corresponding values:</p><ul><li><p><code>"overlap"</code> - This column is always included.</p></li>
<li><p><code>"concordance"</code> - includes <code>1</code> (concordant) and <code>-1</code> (discordant)</p></li>
<li><p><code>"agreement"</code> - includes <code>"agreement"</code> and <code>"disgreement"</code></p></li>
<li><p><code>"each"</code> - includes sign values <code>-1</code> and <code>1</code>.</p></li>
</ul></li>
<li><p><code>"overlap"</code> - integer vector with overlap values, where <code>0</code> and <code>1</code>
indicate which sets contained these items. This column is always included,
even when <code>overlap_type</code> is something else.</p></li>
<li><p><code>"num_sets"</code> - integer number of sets represented in the overlap.</p></li>
<li><p><code>"count"</code> - integer number of items in the overlap.</p></li>
<li><p>one colname for each set name represented in the <code>"sets"</code> column,
intended to help filter by each set. Values will be <code>0</code> or <code>1</code>.</p></li>
<li><p><code>overlap_label</code> - will represent only the non-0 elements from
<code>"overlap"</code> for convenience.</p></li>
<li><p><code>"items"</code> - when <code>return_items=TRUE</code> this column will contain
a <code>list</code> (in <code>AsIs</code> format) of <code>character</code> vectors, with the items.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is the core function to summarize overlaps
that include signed directionality. It is intended for
situations where two sets may share items, but where the
signed direction associated with those items may or may
not also be shared.</p>
<p>One motivating example is with biological data, where
a subset of genes, proteins, or regions of genome, may be
regulated up or down, and this direction is relevant
to understanding the biological process. Two experiments
may identify similar genes, proteins, or regions of
genome, but they may not regulate them in the same
direction. This function is intended to help summarize
item overlaps alongside the directionality of each item.</p>
<p>The directional counts can be summarized in slightly different
ways, defined by the argument <code>overlap_type</code>:</p><ul><li><p><code>overlap_type="detect"</code> - default behavior: each vector in <code>setlist</code>
is handled independently:</p><ul><li><p>a vector with no names will use the vector
values as items after converting them to <code>character</code>;</p></li>
<li><p>a named vector with <code>character</code> or <code>factor</code> values
will will use the vector names as items,
and character values as item values;</p></li>
<li><p>a named vector with <code>numeric</code> or <code>integer</code> values
will use vector names as items, and will convert
numeric values to <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign()</a></code>.</p></li>
</ul></li>
<li><p><code>overlap_type="each"</code> - this option returns all possible
directions individually counted.</p></li>
<li><p><code>overlap_type="concordance"</code> - this option returns the counts
for each consistent direction, for example <code>"up-up-up"</code> would
be counted, and <code>"down-down-down"</code> would be counted, but any
mixture of <code>"up"</code> and <code>"down"</code> would be summarized and counted
as <code>"mixed"</code>. For 3-way overlaps, there are 8 possible directions,
the labels are difficult to place in the Venn diagram, and are not
altogether meaningful. Note that this option is the default
for <code><a href="venndir.html">venndir()</a></code>.</p></li>
<li><p><code>overlap_type="overlap"</code> - this option only summarizes overlaps
without regard to direction. This option returns standard Venn
overlap counts.</p></li>
<li><p><code>overlap_type="agreement"</code> - this option groups all directions
that agree and returns them as <code>"concordant"</code>, all others are
returned as <code>"mixed"</code>.</p></li>
</ul><p>Note that <code>overlap_type="agreement"</code> and <code>overlap_type="concordance"</code>
will not convert <code>numeric</code> values to <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign()</a></code>, so if the input
contains <code>numeric</code> values such as <code>1.2435</code> they should probably be
converted to <code><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign()</a></code> before calling <code>signed_overlaps()</code>, for example:
<code>signed_overlaps(lapply(setlist, sign))</code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other venndir core:
<code><a href="render_venndir.html">render_venndir</a>()</code>,
<code><a href="textvenn.html">textvenn</a>()</code>,
<code><a href="venn_meme.html">venn_meme</a>()</code>,
<code><a href="venndir.html">venndir</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">setlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_venn_test.html">make_venn_test</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">2</span>, do_signed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">setlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_venn_test.html">make_venn_test</a></span><span class="op">(</span><span class="fl">1e6</span>, <span class="fl">3</span>, do_signed<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># so is a data.frame</span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">&lt;-</span> <span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:11</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Processing input setlist.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:11</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Processing overlap_type='</span><span style="color: #FF8700;">detect</span><span style="color: #00AFFF;">'</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:11</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Creating other data types.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Creating overlap vector.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Creating concordance vector.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Creating split names.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Creating final vector.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Splitting by observed directions per overlap.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Creating labels for each split.</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Processing include_blanks=</span><span style="color: #FF8700;">TRUE</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ##  (<span style="color: #00FFFF; font-weight: bold;">18:58:12</span>) 13Apr2025:   <span style="color: #FF8700;">signed_overlaps(): </span><span style="color: #00AFFF;">Sorting rows by overlap count then set.</span> </span>
<span class="r-in"><span><span class="va">so</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      sets overlap num_sets  count set_A set_B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0 0                         set_A   1 0 0        1  29914     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1 0                         set_B   0 1 0        1 378895     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_C|0 0 1                         set_C   0 0 1        1  74287     0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1 0             set_A&amp;set_B   1 1 0        2  27516     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_C|1 0 1             set_A&amp;set_C   1 0 1        2   5479     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B&amp;set_C|0 1 1             set_B&amp;set_C   0 1 1        2  68631     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B&amp;set_C|1 1 1 set_A&amp;set_B&amp;set_C   1 1 1        3   4995     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         set_C overlap_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0 0                 0             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1 0                 0             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_C|0 0 1                 1             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1 0           0           1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_C|1 0 1           1           1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B&amp;set_C|0 1 1           1           1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B&amp;set_C|1 1 1     1         1 1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># detect overlap_type</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, <span class="st">"detect"</span><span class="op">)</span>, <span class="st">"overlap_type"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "overlap"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">setlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_venn_test.html">make_venn_test</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">2</span>, do_signed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># detect overlap_type</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, <span class="st">"detect"</span><span class="op">)</span>, <span class="st">"overlap_type"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "concordance"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># straight overlap counts</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, <span class="st">"overlap"</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        sets overlap num_sets count set_A set_B overlap_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0             set_A     1 0        1    25     1     0             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1             set_B     0 1        1     9     0     1             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1 set_A&amp;set_B     1 1        2     7     1     1           1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># each directional overlap count</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, <span class="st">"each"</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          sets  each overlap num_sets count set_A set_B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|-1 0              set_A  -1 0     1 0        1    13     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0               set_A   1 0     1 0        1    12     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 -1              set_B  0 -1     0 1        1     4     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1               set_B   0 1     0 1        1     5     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|-1 -1 set_A&amp;set_B -1 -1     1 1        2     2     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|-1 1  set_A&amp;set_B  -1 1     1 1        2     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1   set_A&amp;set_B   1 1     1 1        2     4     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   overlap_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|-1 0                   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 -1                   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|-1 -1         -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|-1 1           -1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1             1 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># concordance overlap counts</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, <span class="st">"concordance"</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          sets concordance overlap num_sets count set_A set_B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|-1 0              set_A        -1 0     1 0        1    13     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0               set_A         1 0     1 0        1    12     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 -1              set_B        0 -1     0 1        1     4     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1               set_B         0 1     0 1        1     5     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|-1 -1 set_A&amp;set_B       -1 -1     1 1        2     2     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1   set_A&amp;set_B         1 1     1 1        2     4     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|mixed set_A&amp;set_B       mixed     1 1        2     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   overlap_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|-1 0                   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|1 0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 -1                   -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|0 1                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|-1 -1         -1 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|1 1             1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|mixed         mixed</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># agreement overlap counts</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">setlist</span>, <span class="st">"agreement"</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              sets agreement overlap num_sets count set_A set_B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|agreement             set_A agreement     1 0        1    25     1     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|agreement             set_B agreement     0 1        1     9     0     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|agreement set_A&amp;set_B agreement     1 1        2     6     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|mixed     set_A&amp;set_B     mixed     1 1        2     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       overlap_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A|agreement           agreement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_B|agreement           agreement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|agreement     agreement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set_A&amp;set_B|mixed             mixed</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test to ensure factor input is handled properly</span></span></span>
<span class="r-in"><span><span class="va">inputlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>setA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   setB<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"E"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">inputlist</span>, return_items<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    sets overlap num_sets count setA setB overlap_label   items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setA|1 0           setA     1 0        1     2    1    0             1    B, D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setB|0 1           setB     0 1        1     3    0    1             1 C, E, F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setA&amp;setB|1 1 setA&amp;setB     1 1        2     1    1    1           1 1       A</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># check to verify</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">inputlist</span>, return_items<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">items</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`setA|1 0`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "B" "D"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`setB|0 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "C" "E" "F"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`setA&amp;setB|1 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "A"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># test specific factor level order</span></span></span>
<span class="r-in"><span><span class="va">inputlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   setA<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"D"</span><span class="op">)</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   setB<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"E"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">signed_overlaps</span><span class="op">(</span><span class="va">inputlist</span>, return_items<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    sets overlap num_sets count setA setB overlap_label   items</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setA|1 0           setA     1 0        1     2    1    0             1    B, D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setB|0 1           setB     0 1        1     3    0    1             1 C, E, F</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setA&amp;setB|1 1 setA&amp;setB     1 1        2     1    1    1           1 1       A</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

