<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Define a polygon label line segment — polygon_label_segment • venndir</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Define a polygon label line segment — polygon_label_segment" />
<meta property="og:description" content="Define a polygon label line segment" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">venndir</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.15.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/venndir_gene_expression.html">Venndir with Gene Expression Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/venndir/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Define a polygon label line segment</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/venndir/blob/master/R/venndir-sp.R'><code>R/venndir-sp.R</code></a></small>
    <div class="hidden name"><code>polygon_label_segment.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Define a polygon label line segment</p>
    </div>

    <pre class="usage"><span class='fu'>polygon_label_segment</span><span class='op'>(</span>
  <span class='va'>x0</span>,
  <span class='va'>x1</span>,
  <span class='va'>y0</span>,
  <span class='va'>y1</span>,
  <span class='va'>sp</span>,
  return_class <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"point"</span>, <span class='st'>"matrix"</span>, <span class='st'>"SpatialLines"</span><span class='op'>)</span>,
  sp_buffer <span class='op'>=</span> <span class='fl'>0</span>,
  plot_debug <span class='op'>=</span> <span class='cn'>FALSE</span>,
  relative <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x0</th>
      <td><p><code>numeric</code> x-axis source position</p></td>
    </tr>
    <tr>
      <th>x1</th>
      <td><p><code>numeric</code> x-axis target position</p></td>
    </tr>
    <tr>
      <th>y0</th>
      <td><p><code>numeric</code> y-axis source position</p></td>
    </tr>
    <tr>
      <th>y1</th>
      <td><p><code>numeric</code> y-axis target position</p></td>
    </tr>
    <tr>
      <th>sp</th>
      <td><p><code><a href='https://rdrr.io/pkg/sp/man/SpatialPolygons.html'>sp::SpatialPolygons</a></code> object representing the polygon</p></td>
    </tr>
    <tr>
      <th>return_class</th>
      <td><p><code>character</code> string where <code>"point"</code> returns a
<code>matrix</code> with one row containing the new target point;
<code>"matrix"</code> contains two rows with source and new target points;
<code>"SpatialLines"</code> returns <code><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>sp::SpatialLines</a></code> with the line
segment from source to new target points.</p></td>
    </tr>
    <tr>
      <th>sp_buffer</th>
      <td><p><code>numeric</code> indicating an optional buffer to
use for the <code>sp</code> polygon. By default <code>sp_buffer=0</code> uses no
buffer, but a suggested buffer <code>sp_buffer=-0.01</code> would make
the polygon <code>1%</code> smaller, therefore the line segment would be
slightly inside the polygon border.</p></td>
    </tr>
    <tr>
      <th>relative</th>
      <td><p><code>logical</code> indicating whether <code>sp_buffer</code> is scaled
relative to the size of the polygon, see <code><a href='get_sp_buffer.html'>get_sp_buffer()</a></code>
for more details.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code> indicating whether to print verbose output,
specifically describing which situation occurred.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are passed to <code><a href='get_sp_buffer.html'>get_sp_buffer()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>numeric</code> matrix with one row, representing the
point of intersection with the polygon boundary,
see comments above for exceptions. When
<code>return_class="matrix"</code> then the <code>matrix</code> contains
two rows, where the second row contains the
point of intersection. When <code>return_class="SpatialLines"</code>
the object is <code><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>sp::SpatialLines</a></code> and represents the
line from the first point and the point of intersection.
Note that when there is no second point, the
<code><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>sp::SpatialLines</a></code> object will only have one point.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes a line segment and polygon, and
returns the point where a line segment starting
at the source point touches the outer boundary of
the polygon.</p>
<p>This function is intended to be used with polygon
labels, where the original label position
is inside the polygon, but is manually adjusted
and may be placed somewhere outside the polygon.
This function finds a suitable point to draw a line
segment from the new label position to the polygon.</p>
<p>Some different situations are handled as follows,
use <code>verbose=TRUE</code> to see which situation occurred.</p><ul>
<li><p>When the starting point is outside the polygon,
and end point is inside the polygon, this function
finds the point where this line segment first
intersects the polygon boundary. This is the
driving reason for this function.</p></li>
<li><p>When the starting point is outside the polygon,
and end point also outside the polygon, this function
finds the nearest the nearest point along
the polygon boundary.</p></li>
<li><p>When the starting point is inside the polygon,
this function returns NULL.</p></li>
</ul>

<p>Note that this function currently does not adjust for
the size or position of a label.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other venndir label: 
<code><a href='draw_gridtext_groups.html'>draw_gridtext_groups</a>()</code>,
<code><a href='polygon_label_fill.html'>polygon_label_fill</a>()</code>,
<code><a href='polygon_label_outside.html'>polygon_label_outside</a>()</code>,
<code><a href='sp_polylabelr.html'>sp_polylabelr</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to boundary intersection"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-1.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example of making a debug plot</span>
<span class='va'>lxy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>y0</span>, <span class='va'>y1</span><span class='op'>)</span><span class='op'>)</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sl</span> <span class='op'>&lt;-</span> <span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>SpatialLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/Line.html'>Lines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/Line.html'>Line</a></span><span class='op'>(</span><span class='va'>lxy</span><span class='op'>)</span><span class='op'>)</span>, ID<span class='op'>=</span><span class='st'>"a"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>;
<span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>sp</span>, col<span class='op'>=</span><span class='st'>"#00007777"</span>, border<span class='op'>=</span><span class='st'>"blue3"</span>, lwd<span class='op'>=</span><span class='fl'>2</span>,
   xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, asp<span class='op'>=</span><span class='fl'>1</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to boundary intersection"</span><span class='op'>)</span>;
</div><div class='input'><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>sl</span>, lty<span class='op'>=</span><span class='st'>"dotted"</span>, lwd<span class='op'>=</span><span class='fl'>2</span>, col<span class='op'>=</span><span class='st'>"blue2"</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>;
</div><div class='input'><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>sl2</span>, col<span class='op'>=</span><span class='st'>"red3"</span>, lwd<span class='op'>=</span><span class='fl'>4</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='polygon_label_segment-2.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example where the line intersects multiple boundaries</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to first boundary intersection"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-3.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example where starting line does not intersect</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>2</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to nearest boundary point"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-4.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='va'>lxy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>y0</span>, <span class='va'>y1</span><span class='op'>)</span><span class='op'>)</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>2</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sl</span> <span class='op'>&lt;-</span> <span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialLines.html'>SpatialLines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/Line.html'>Lines</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/Line.html'>Line</a></span><span class='op'>(</span><span class='va'>lxy</span><span class='op'>)</span><span class='op'>)</span>, ID<span class='op'>=</span><span class='st'>"a"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp</span>, <span class='st'>"SpatialLines"</span><span class='op'>)</span>; 
<span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>sl</span>, xlim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3</span><span class='op'>)</span>, ylim<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span>, asp<span class='op'>=</span><span class='fl'>1</span>, lty<span class='op'>=</span><span class='st'>"dotted"</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to nearest boundary point"</span><span class='op'>)</span>;
</div><div class='input'><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>sp</span>, col<span class='op'>=</span><span class='st'>"#00007777"</span>, border<span class='op'>=</span><span class='st'>"navy"</span>, lwd<span class='op'>=</span><span class='fl'>2</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>sp</span><span class='fu'>::</span><span class='fu'>plot</span><span class='op'>(</span><span class='va'>sl2</span>, col<span class='op'>=</span><span class='st'>"red"</span>, lwd<span class='op'>=</span><span class='fl'>4</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='polygon_label_segment-5.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example showing line fully inside the polygon</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>1.5</span>, yradius<span class='op'>=</span><span class='fl'>2.2</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment contained inside returns one point"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-6.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example showing polygon with a hole inside</span>
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sp_hole</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.2</span>, yradius<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>;
<span class='va'>sp_donut</span> <span class='op'>&lt;-</span> <span class='fu'>rgeos</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rgeos/man/topo-bin-gDifference.html'>gDifference</a></span><span class='op'>(</span><span class='va'>sp</span>, <span class='va'>sp_hole</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp_donut</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to first outer boundary intersection"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-7.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example with line inside the polygon hole</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0.9</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>1.1</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0.9</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>1.1</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sp_hole</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.2</span>, yradius<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>;
<span class='va'>sp_donut</span> <span class='op'>&lt;-</span> <span class='fu'>rgeos</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rgeos/man/topo-bin-gDifference.html'>gDifference</a></span><span class='op'>(</span><span class='va'>sp</span>, <span class='va'>sp_hole</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp_donut</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to nearest boundary"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-8.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># line crosses inside the polygon hole</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>1.4</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>1.4</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sp_hole</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.2</span>, yradius<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>;
<span class='va'>sp_donut</span> <span class='op'>&lt;-</span> <span class='fu'>rgeos</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rgeos/man/topo-bin-gDifference.html'>gDifference</a></span><span class='op'>(</span><span class='va'>sp</span>, <span class='va'>sp_hole</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp_donut</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"segment drawn to boundary intersection"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-9.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fl'>0.6</span>;<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fl'>0.6</span>; <span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>;
<span class='va'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.5</span>, yradius<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>;
<span class='va'>sp_hole</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sp_ellipses.html'>sp_ellipses</a></span><span class='op'>(</span>xcenter<span class='op'>=</span><span class='fl'>1</span>, ycenter<span class='op'>=</span><span class='fl'>1</span>, xradius<span class='op'>=</span><span class='fl'>0.2</span>, yradius<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>;
<span class='va'>sp_donut</span> <span class='op'>&lt;-</span> <span class='fu'>rgeos</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/rgeos/man/topo-bin-gDifference.html'>gDifference</a></span><span class='op'>(</span><span class='va'>sp</span>, <span class='va'>sp_hole</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, <span class='va'>sp_donut</span>,
   return_class<span class='op'>=</span><span class='st'>"SpatialLines"</span>,
   plot_debug<span class='op'>=</span><span class='cn'>TRUE</span>,
   main<span class='op'>=</span><span class='st'>"first point inside the polygon, returns one point"</span><span class='op'>)</span>;
</div><div class='img'><img src='polygon_label_segment-10.png' alt='' width='768' height='768' /></div><div class='input'>
<span class='co'># example showing multiple input points</span>
<span class='va'>x0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='fl'>1.1</span><span class='op'>)</span>;
<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1.4</span><span class='op'>)</span>;
<span class='va'>y0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.6</span>, <span class='fl'>1.1</span><span class='op'>)</span>;
<span class='va'>y1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1.4</span><span class='op'>)</span>;
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, sp<span class='op'>=</span><span class='va'>sp_donut</span>,
   return_class<span class='op'>=</span><span class='st'>"point"</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span>, plot_debug<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>; 
</div><div class='output co'>#&gt; ##  (<span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>j:</span><span style='color: #FF8700;'>1</span><span style='color: #00AFFF;'>, spi[j]:</span><span style='color: #FF8700;'>1</span><span> </div><div class='img'><img src='polygon_label_segment-11.png' alt='' width='768' height='768' /></div><div class='output co'>#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>The first point is inside the polygon.</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>j:</span><span style='color: #FF8700;'>2</span><span style='color: #00AFFF;'>, spi[j]:</span><span style='color: #FF8700;'>1</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>The first point is outside the polygon.</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>Using first outer line segment </span><span style='color: #FF8700;'>1</span><span> </div><div class='input'>
<span class='co'># example showing sp_buffer</span>
<span class='va'>sl2</span> <span class='op'>&lt;-</span> <span class='fu'>polygon_label_segment</span><span class='op'>(</span><span class='va'>x0</span>, <span class='va'>x1</span>, <span class='va'>y0</span>, <span class='va'>y1</span>, sp<span class='op'>=</span><span class='va'>sp_donut</span>,
   sp_buffer<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.1</span>,
   return_class<span class='op'>=</span><span class='st'>"point"</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span>, plot_debug<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>; 
</div><div class='output co'>#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>j:</span><span style='color: #FF8700;'>1</span><span style='color: #00AFFF;'>, spi[j]:</span><span style='color: #FF8700;'>1</span><span> </div><div class='img'><img src='polygon_label_segment-12.png' alt='' width='768' height='768' /></div><div class='output co'>#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>Applied sp_buffer:</span><span style='color: #FF8700;'>-0.1</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>The first point is inside the polygon.</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>j:</span><span style='color: #FF8700;'>2</span><span style='color: #00AFFF;'>, spi[j]:</span><span style='color: #FF8700;'>1</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>Applied sp_buffer:</span><span style='color: #FF8700;'>-0.1</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>The first point is outside the polygon.</span><span> 
#&gt; ##  (</span><span style='color: #00D7D7;font-weight: bold;'>14:03:46</span><span>) 10Mar2021:  </span><span style='color: #FF8700;'>polygon_label_segment(): </span><span style='color: #00AFFF;'>Using first outer line segment </span><span style='color: #FF8700;'>1</span><span> </div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


