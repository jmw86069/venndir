<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>TODO for venndir • venndir</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="TODO for venndir"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">venndir</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.50.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/venndir_gene_expression.html">Venndir with Gene Expression Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jmw86069/venndir/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>TODO for venndir</h1>
      <small class="dont-index">Source: <a href="https://github.com/jmw86069/venndir/blob/HEAD/TODO.md" class="external-link"><code>TODO.md</code></a></small>
    </div>

<div id="todo-for-venndir" class="section level1">

<div class="section level2">
<h2 id="id_12apr2025">12apr2025<a class="anchor" aria-label="anchor" href="#id_12apr2025"></a></h2>
<ul><li><p>Signed labeling: Hide concordance/agreement for singlets, improve method to curate signs.</p></li>
<li><p>DONE. Require marquee&gt;=1.0.0 in order to avoid the rare R crash on MacOS when using fonts whose font file path includes a space.</p></li>
<li>
<p>MOSTLY COMPLETE. Consider transitioning all text grobs to use types:</p>
<ul><li>
<code><a href="https://marquee.r-lib.org/reference/marquee_grob.html" class="external-link">marquee::marquee_grob()</a></code>, <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::textGrob()</a></code>, <code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code>
</li>
<li>Consider theming or argument to specify which type of grob to use.</li>
<li>Only marquee guarantees Unicode arrows, but lacks enhanced markdown in <code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code> such as css styling, and inserted images.</li>
</ul></li>
<li><p>DONE. Consider wrapper for <code><a href="https://marquee.r-lib.org/reference/marquee_grob.html" class="external-link">marquee::marquee_grob()</a></code> as drop-in replacement for <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::textGrob()</a></code>, specifically to use with <code><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">gridExtra::tableGrob()</a></code></p></li>
<li><p>Migrate item text rendering to permit marquee, deprecating gridtext.</p></li>
</ul></div>
<div class="section level2">
<h2 id="id_04apr2025">04apr2025<a class="anchor" aria-label="anchor" href="#id_04apr2025"></a></h2>
<ul><li><p>Consider new <code>show_labels</code> option “T” for Total count per group, Dimitris for example used “Set A (1,234)”</p></li>
<li>
<p>DONE. Consider dependency <code>marquee(&gt;=1.0.0)</code></p>
<ul><li>It requires <code>freetype2</code> (libfreetype) which may not be available conveniently on all systems.</li>
<li>Otherwise it could resolve “all” issues with Unicode characters, using internal font substitutions where necessary.</li>
<li>Potential drop-in replacement for: <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::textGrob()</a></code>
</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_28mar2025">28mar2025<a class="anchor" aria-label="anchor" href="#id_28mar2025"></a></h2>
<ul><li>
<p>PARTIAL. Fix issue with <code>fontfamily</code> sometimes not displaying Unicode arrows.</p>
<ul><li>Default <code>fontfamily="sans"</code> does not work for default MacOS on external device (non-ragg). “Helvetica” does not work on linux.</li>
<li>Consider dependency ‘systemfonts&gt;=1.1.0’, test whether it automatically upgrades the Unicode glyph matching.</li>
<li>On MacOS R-4.3.3 using ‘r-oldrel’ the binary packages are marquee-0.1.0, systemfonts-1.1.0 which are old, before the crash fix (spaces in font filenames cause segfault and crash R session). Installing from source fails, it requires an updated build flag: <code>withr::with_makevars(c(OBJCXXFLAGS = "${CXX17STD}"), install.packages('marquee', type='source'))</code> However it still fails to find the conda-installed <code>libfreetype.6.dylib</code>, unknown reason.</li>
</ul></li>
<li>
<p><code><a href="reference/venndir.html">venndir()</a></code></p>
<ul><li>DONE. Change defaults back to <code>innerborder.lwd=0.5</code>, <code>outerborder.lwd=0.5</code>, borders should be less visibly intrusive.</li>
<li>Consider global option “lwd” that effectively scales existing line widths, as convenient way to adjust lines.</li>
<li>DONE. Make <code>fontfamily</code> work by default for all common devices, meaning the upArrow and downArrow unicode should be properly displayed. Currently <code>fontfamily="sans"</code> MacOS displays [] empty boxes for arrows when not using ragg RStudio graphics device. Ugh.</li>
<li>
<code>overlap_type="agreement"</code> should hide the signed counts for individual (non-overlapping) sets. It is not meaningful to say hits are in agreement when it only involves one set.</li>
<li>Small thing: Red + blue = purple. The purple needs improvement.</li>
<li>
<code>show_labels</code> should be vectorized, to apply to each overlap in order. (This is not as intuitive as you’d think since the sets appear in label_df, then the overlap sets.)</li>
</ul></li>
<li>
<p>Improve <code><a href="reference/make_color_contrast.html">make_color_contrast()</a></code></p>
<ul><li>Fix <code>C_floor</code>. Figure out why output colors are desaturated.</li>
</ul></li>
<li>
<p>Improve <code><a href="reference/curate_venn_labels.html">venndir::curate_venn_labels()</a></code></p>
<ul><li>Make default <code>curate_df</code> more visible. Perhaps a package object?</li>
</ul></li>
<li>
<p>Consider “Upset” export to UpSetR, and/or the ComplexHeatmap implementation.</p>
<ul><li>Bonus points for figuring out if it’s possible to include sign, for example in ComplexHeatmap can the bars be stacked, colorized by sign?</li>
</ul></li>
<li>
<p>Consider some type of “styling” object or system, with overall settings:</p>
<ul><li>innerborder, innerborder.lwd, outerborder, outerborder.lwd, border, border.lwd,</li>
<li>template (tall/wide),</li>
<li>fontfamily/fontfamilies, fontsizes, fontfaces, fontcolors, label_spacing (list), label_padding (list),</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_10mar2025">10mar2025<a class="anchor" aria-label="anchor" href="#id_10mar2025"></a></h2>
<ul><li>DONE. Make <code><a href="reference/venndir_legender.html">venndir_legender()</a></code> title labels customizable.</li>
<li>Partial. Add legend to <code><a href="reference/textvenn.html">textvenn()</a></code>. Capability is there, not included into the function yet. Want to add color.</li>
<li>Consider <code>venndir_options()</code> as mechanism to adjust default values.</li>
<li>Consider method to convert <code><a href="reference/signed_overlaps.html">signed_overlaps()</a></code> to setlist.</li>
<li>Consider helper function <code>is_signed()</code> to review <code>list</code> input.</li>
<li>Consider long-term approach to <code>label_fill()</code> that more accurately fits/resizes/positions labels into the available space. Similar to however wordcloud tools work.</li>
</ul></div>
<div class="section level2">
<h2 id="id_05mar2025">05mar2025<a class="anchor" aria-label="anchor" href="#id_05mar2025"></a></h2>
<ul><li>
<p>Consider ggplot2</p>
<ul><li>perhaps new geoms (JamPolygon compatibility)</li>
<li>potential ability to use <code>ggrepel</code>
</li>
</ul></li>
<li><p>Consider option for shadowText, <code>ggshadowtext</code> for clarity of text</p></li>
<li><p>Consider small, “logo-size” Venn graphic, simplified to use in smaller schematics, insets, or <code>gt</code> tables similar to sparklines. See <code>gtExtras</code> package for example sparklines. Perhaps venndir there?</p></li>
<li><p>Consider: Filling polygon by color to indicate % concordance? Similar to using <code>show_items="sign"</code> except proper area fill.</p></li>
</ul></div>
<div class="section level2">
<h2 id="id_24jan2025">24jan2025<a class="anchor" aria-label="anchor" href="#id_24jan2025"></a></h2>
<ul><li>
<p>Fancy ideas for item labeling. Problem: Sometimes with gene symbols, most genes are short “APOE”, “MAP3K1”, but others are “ENSMUSG00000141751”. Consider strategy to handle “long strings”.</p>
<ol style="list-style-type: decimal"><li>
<p>Define “long string”</p>
<ul><li>multiple words?</li>
<li>more than x-fold <code><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar()</a></code> character length than median length?</li>
<li>more than fixed <code><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar()</a></code> character length, and/or number of words?</li>
</ul></li>
<li>
<p>Strategies to handle</p>
<ul><li>shrink the font size, proportional to string length.</li>
<li>For long item strings, use a narrow font. Might handle 2-fold effects.</li>
<li>Consider word wrap, only useful for multi-words. Or hyphenated?</li>
<li>Consider option to truncate after max <code><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar()</a></code> or max words.</li>
</ul></li>
</ol></li>
</ul></div>
<div class="section level2">
<h2 id="id_17jan2025">17jan2025<a class="anchor" aria-label="anchor" href="#id_17jan2025"></a></h2>
<ul><li>Consider option not to merge count and outside set labels, particularly when the count label is placed outside. Currently the counts for “A” are placed underneath set label “A” when it appears outside. This grouping makes sense sometimes, but may not make sense with proportional labels, especially when the set label is manually nudged in the figure.</li>
</ul></div>
<div class="section level2">
<h2 id="id_13jan2025">13jan2025<a class="anchor" aria-label="anchor" href="#id_13jan2025"></a></h2>
<ul><li>
<p>Implement specific methods to handle DEG results as input</p>
<ul><li>DESeq2 “hits”</li>
<li>limma-voom hits - either by <code><a href="https://rdrr.io/pkg/limma/man/toptable.html" class="external-link">limma::topTable()</a></code>
</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_10jan2025">10jan2025<a class="anchor" aria-label="anchor" href="#id_10jan2025"></a></h2>
<ul><li>
<p>DONE. Further refine label spacing. Currently assembles multiple gtables, however the outer buffers add, making the gap between label types too large. Strategies to try:</p>
<ul><li>DONE. <code><a href="https://gtable.r-lib.org/reference/gtable_add_space.html" class="external-link">gtable::gtable_add_row_space()</a></code>, <code><a href="https://gtable.r-lib.org/reference/gtable_add_padding.html" class="external-link">gtable::gtable_add_padding()</a></code> - more clearly apply spacing between multi-rows of the same label type, spacing between rows of different label types, then padding around the grouped label.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_09dec2024">09dec2024<a class="anchor" aria-label="anchor" href="#id_09dec2024"></a></h2>
<ul><li>DONE. Consider “vertical” item label fill geometry, for “columnar arrangement”.</li>
<li>Make font label spacing scale up or down with font size.</li>
<li>Consider multi-column legend, to make it wider and flatter.</li>
<li>Debug outside label positioning with 4+ proportional sets.</li>
<li>Debug error with empty proportional sets.</li>
<li>Consider <code>bookdown</code> package docs with examples.</li>
<li>Allow custom item fontface.</li>
<li>Allow item coordinate nudging, and/or customization/persistence.</li>
<li>Combine help docs for <code><a href="reference/venndir.html">venndir()</a></code> and <code><a href="reference/render_venndir.html">render_venndir()</a></code>.</li>
<li>Consider <code><a href="reference/textvenn.html">textvenn()</a></code> option for HTML output, via <code>print_colordf()</code>
</li>
</ul></div>
<div class="section level2">
<h2 id="id_05dec2024">05dec2024<a class="anchor" aria-label="anchor" href="#id_05dec2024"></a></h2>
<ul><li>
<p>Improve outside label assignment, use nearest available outside point, after labels are spread by <code>min_degrees</code>.</p>
<ul><li>Iterate each outside label, find nearest point/distance. For labels sharing the same nearest point, assign to closest one. Repeat.</li>
<li>Can be added into <code><a href="reference/label_outside_JamPolygon.html">label_outside_JamPolygon()</a></code> as second step, after it calculates the label position outside (or simulates that).</li>
<li>Larger rework would be to assign outside labels only when needed, then reassign also only when adding or removing outside visibility? Might be unnecessary if the rework above is effective.</li>
</ul></li>
<li>
<p>Consider some visual default settings?</p>
<ul><li>no set border</li>
<li>white set border</li>
</ul></li>
<li><p>Consider adding <code>outerborder</code>,<code>innerborder</code> optional <code>...</code> arguments, into the Venndir metadata for persistence?</p></li>
<li>
<p>Fix overlap labels shown outside for fully internalized sets, proportional.</p>
<ul><li>An intersection overlap count should not be positioned outside together with an outside set label, since it means something different outside.</li>
<li>Overlap count label is not properly “grouped” with parent set label, though it is co-located. It should probably not be co-located, since it has different meaning than other unique set overlap labels.</li>
</ul></li>
<li><p>DONE. Debug multi-line overlap label being cropped when second line is wider than the first line. Potential error with <code>"grobwidth"</code>.</p></li>
<li>
<p>Legend:</p>
<ul><li>DONE. Add some buffer space for left-aligned counts in “Size” column.</li>
<li>Consider option not to colorize the legend.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_30nov2024">30nov2024<a class="anchor" aria-label="anchor" href="#id_30nov2024"></a></h2>
<ul><li><p>Consider option to “flip/mirror” the coordinates, for example trying to reproduce published layout, or optimize visual order of labels.</p></li>
<li>
<p>Refactor label rendering</p>
<ul><li><p>New functions <code>assembly_venndir_label()</code>, <code>repack_grobs()</code>.</p></li>
<li><p>Change to use <code><a href="https://rdrr.io/r/grid/grid.frame.html" class="external-link">grid::frameGrob()</a></code> to build label parts.</p></li>
<li><p>Store font style in metadata, optionally per-overlap in <code>label_df</code>. Consider: main, count, signed, item</p></li>
<li><p>Store <code>template</code> in metadata, optionally per-overlap in <code>label_df</code></p></li>
<li><p>Store <code>show_labels</code> in metadata, optionally per-overlap in <code>label_df</code></p></li>
<li>
<p>Consider using <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::textGrob()</a></code> as default.</p>
<ul><li>Make <code>gridtext</code> and/or <code>marquee</code> optional?</li>
</ul></li>
</ul></li>
<li>
<p><code><a href="reference/render_venndir.html">render_venndir()</a></code></p>
<ul><li>call new label functions, drop <code>draw_gridtext_groups()</code>
</li>
<li>drop <code>group_labels</code> argument</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_19nov2024">19nov2024<a class="anchor" aria-label="anchor" href="#id_19nov2024"></a></h2>
<p>Residual todo items of note:</p>
<ul><li>
<p>Legend</p>
<ul><li>DONE. Optional signed counts and percentage to legend.</li>
</ul></li>
<li>
<p>Item labels</p>
<ul><li><p>DONE. Debug: 4-way Venn may not be applying <code>item_cex</code> properly.</p></li>
<li><p>Consider adding <code>item_fontfamily</code> to be distinct from other labels.</p></li>
<li><p>DONE. <code>cex</code> fontsize adjustment seems not quite right.</p></li>
<li><p>Revisit <code>item_buffer</code>, <code>width_buffer</code>, other ideas to position labels inside polygons.</p></li>
<li><p>Consider optional columns for item labels in <code>label_df</code>: coords, label cex/fontsize, border, fill, fontcolor. When <code>NA</code> use automated/defaults, otherwise they override.</p></li>
<li>
<p>Consider radically different approach to <code><a href="reference/label_fill_JamPolygon.html">label_fill_JamPolygon()</a></code></p>
<ul><li>Brute force placement of labels.</li>
<li>Create item label grobs, calculate absolute height/width bounding boxes</li>
<li>Divide into N rows, start top-left, move left-to-right, place labels inside the polygon, in order, prevent overlapping labels. Repeat on each row.</li>
<li>If not all labels fit, down-size labels and try again. Use adaptive sizing as in <code><a href="reference/sample_JamPolygon.html">sample_JamPolygon()</a></code>.</li>
<li>Final result: delete original item grobs, create new grobs with final font scaling, using coordinates as determined.</li>
<li>Consider allowing positive <code>buffer</code> to allow some spillover outside?</li>
</ul></li>
</ul></li>
<li>
<p>Test <code>marquee</code> as drop-in replacement for <code>gridtext</code>. Goals:</p>
<ul><li>Note it requires R-4.3.0 or higher, might be too restrictive.</li>
<li>Improve inconsistent font kerning</li>
<li>Enable custom styling of labels.</li>
<li>Test large number of item labels compared with grid and gridtext.</li>
</ul></li>
<li>
<p>Improve label kerning irregularities. Possible show-stopper for signed labels and sign item labels. Arrows are rendered wider than internal font metrics.</p>
<ul><li>Linux system font kerning is inconsistent, unclear whether it is specific to gridtext, or <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::grid.text()</a></code> also.</li>
<li>Most labels could be created parts, then assembled.</li>
<li>
<code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::grid.text()</a></code> could be used instead of <code>gridtext</code> for most labels. Test <code>grid.text()</code> as drop-in replacement for <code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code>. Note it lacks <code>r</code>,<code>padding</code>.</li>
<li>
<code>marquee</code> could also be drop-in replacement. If it works best, all <code>gridtext</code> should be replaced with <code>marquee</code>.</li>
</ul></li>
<li>
<p>Test PDF output with different font choices. Compare with <code>ragg_png</code>.</p>
<ul><li>Need automated tests for PDF and PNG output. Not sure how yet.</li>
</ul></li>
<li>
<p><code><a href="reference/textvenn.html">textvenn()</a></code></p>
<ul><li>Enable multi-line headers in output</li>
<li>Add optional legend with counts</li>
</ul></li>
<li>
<p><code>README.Rmd</code></p>
<ul><li>Add <code><a href="reference/venn_meme.html">venn_meme()</a></code>
</li>
</ul></li>
<li>
<p>Lower priority ideas</p>
<ul><li>
<p>Consider other directional metrics, similar to “percent” label</p>
<ul><li>Jaccard overlap</li>
<li>Kruskal concordance: (agree - disagree)/(n)</li>
<li>Others: Cohen’s Kappa; Holley and Guilford’s G; Hubert’s Gamma; Yule’s coefficient of association Q</li>
<li>Ingenuity directional z-score (for a single set)</li>
</ul></li>
<li>
<p>DONE. <code><a href="reference/sample_JamPolygon.html">sample_JamPolygon()</a></code></p>
<ul><li>DONE. Consider more organic/efficient algorithm: instead of linear testing across <code>n_seq</code>, do sparse testing, then fine-tune. E.g. requested: 100; try 100, 150, 200; 150 failed, 200 worked; next try 175; if success try 162, if fail try 188; try 188; if success try 194</li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_12nov2024">12nov2024<a class="anchor" aria-label="anchor" href="#id_12nov2024"></a></h2>
<ul><li>
<p>item labeling</p>
<ul><li><p>Consider storing item label coordinates in the <code>Venndir</code> object. Then <code><a href="reference/render_venndir.html">render_venndir()</a></code> must be able to re-use item labels. It would allow editing the coordinates for fine-tuning.</p></li>
<li>
<p>Consider alternatives to <code><a href="reference/label_fill_JamPolygon.html">label_fill_JamPolygon()</a></code> to fill labels inside a polygon. Ideally, it minimizes overlapping labels, and maximizes placement of labels inside each polygon.</p>
<ul><li>Consider defining <code>adj</code> based upon label relative distance to left-right edges of the polygon. Doing so would allow labels to fit cleanly within the polygon.</li>
<li>Evaluate <code>wordcloud</code> type approaches which can fill text words into a polygon shape. Github <code>"Lchiffon/wordcloud2"</code> also on CRAN. Note: <code>wordcloud2</code> produces HTML/javascript, it also requires black-and-white mask for each shape, then places words inside the shape using active javascript. It often needs web page refresh.</li>
</ul></li>
<li><p>Consider permitting item border and fill.</p></li>
</ul></li>
<li>
<p>Font and character handling</p>
<ul><li>
<p>Consider <code>marquee</code> package for potentially more robust unicode character and font handling.</p>
<ul><li>It would involve converting existing markdown/HTML to CommonMark format, which uses styles by name.</li>
<li>Named styles could enable more flexible control over labeling overall. E.g. <code>count</code> could be a <code><a href="https://marquee.r-lib.org/reference/style.html" class="external-link">marquee::style()</a></code> with fontfamily, fontsize, color, etc.</li>
</ul></li>
</ul></li>
<li>
<p><code><a href="reference/textvenn.html">textvenn()</a></code></p>
<ul><li><p>Consider optional text legend, counts per set, with total.</p></li>
<li>
<p>Consider optional multi-line headers, with one line per set name.</p>
<ul><li>Goal: Prevent generating a very wide table.</li>
<li>Requires changes to the <code>data.frame</code> structure, very doable.</li>
<li>Consider supporting multi-line set names? Split them across rows using similar logic.</li>
</ul></li>
<li><p>Consider option to display items beneath counts? Probably not practical, but could be combined with <code>max_items=20</code>, then abbreviate the item listing, something similar to: <code>"item1, item2, item3, ... (523 others)"</code>. Or: <code>cli::ansi_collapse(letters, style="head", trunc=20, ellipsis="...")</code>, but split across multiple lines.</p></li>
</ul></li>
<li>
<p><code><a href="reference/venndir.html">venndir()</a></code>, <code><a href="reference/render_venndir.html">render_venndir()</a></code> - labeling placement options</p>
<ul><li>
<p>Fix the <code>grobs_tile()</code> spacing, remove overlap with percent labels.</p>
<ul><li>This issue might be solved with <code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png()</a></code> font handling.</li>
</ul></li>
<li><p>Find reproducible example of bad font kerning, post issue to <code>gridtext</code>. Consider <code>marquee</code> as alternative.</p></li>
<li>
<p>Consider adjustments to inner/outer labels. Examples:</p>
<ul><li>Option to show counts/percentage only when the overlap label is shown.</li>
<li>Option to show overlap label for outside counts, e.g. <code>"setA&amp;setB"</code>. Probably need to split across multiple lines.</li>
</ul></li>
<li><p>Consider shorter default <code>segment_distance</code>.</p></li>
</ul></li>
<li>
<p><code>JamPolygon</code> plotting</p>
<ul><li>Need a method for adding components to venndir plot <code>grid</code> elements, e.g. text labels, points, any <code>grid</code> object.</li>
<li>Use case could be obtaining <code>grid</code> object, detecting the <code>gTree</code> elements by name, then adjusting item label positions?</li>
<li>Consider conversion to polypath-compatible coordinates, and <code>sf</code>.</li>
</ul></li>
<li>
<p>DONE. <code>Venndir</code> polygon manipulations</p>
<ul><li>DONE. customize an overlap: fill color, innerborder/outerborder/border</li>
</ul></li>
<li>
<p>Add accessors to the <code>Venndir</code> object</p>
<ul><li>DONE. setlist</li>
<li>DONE. <code>overlaplist()</code> - overlap item list</li>
<li>DONE. <code>signed_counts()</code> - return overlap count list</li>
<li>DONE. (<code>overlapdf()</code> and <code><a href="reference/venndir_to_df.html">venndir_to_df()</a></code>), alternatively: <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> - using the <code>setAs()</code> methodology. Convenient conversion to <code>data.frame</code> format.</li>
</ul></li>
<li>
<p>Summarize advice for fonts, plot resolution, anti-aliasing, etc.</p>
<ul><li>
<code><a href="https://ragg.r-lib.org/reference/agg_png.html" class="external-link">ragg::agg_png()</a></code> provides a notable improvement over <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png()</a></code>, in RMarkdown put <code>dev="ragg_png"</code> in the kntir options, for example: <code>knitr::opts_chunk$set(dev="ragg_png")</code>
</li>
</ul></li>
<li>
<p>Consider other S4 objects?</p>
<ul><li>
<p><code>Setlist</code> - consistent representation for setlist</p>
<ul><li>When <code><a href="reference/signed_overlaps.html">signed_overlaps()</a></code> is run, it first “detects” input type, then converts data accordingly. It could be stored properly.</li>
<li>list, signed list, incidence matrix, signed incidence matrix.</li>
</ul></li>
<li><p><code>SignedOverlaps</code> - Structured info</p></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_08nov2024">08nov2024<a class="anchor" aria-label="anchor" href="#id_08nov2024"></a></h2>
<ul><li>
<p>Based upon some excellent feedback:</p>
<ul><li>DONE. Move default labels above, not beside the Venn diagram.</li>
<li>DONE. Add option for a plot title.</li>
<li>DONE. Related, make it “easy” to adjust outer labels.</li>
<li>DONE. Add option for signed counts below main counts in one column.</li>
<li>Add option to display signed counts in the legend.</li>
<li>Add option to display percentage in the legend.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_01nov2024">01nov2024<a class="anchor" aria-label="anchor" href="#id_01nov2024"></a></h2>
<ul><li>
<p>Item label enhancements</p>
<ul><li>
<p>Debug <code>item_cex</code> and <code>item_cex_factor</code> not being applied as expected.</p>
<ul><li>Consider assigning <code>item_cex</code> to <code>label_df</code> or <code>jps</code> for persistence.</li>
<li>Consider specific logic when <code>proportional=TRUE</code> to assume that all polygons are already proportional to the number of items.</li>
</ul></li>
<li><p>Consider option to retain item factor order when provided, to control the order they are placed.</p></li>
<li><p>Consider some method to adjust the relative “height” of item labels, for example multi-line labels should take proportionally more height?</p></li>
<li><p>Allow custom <code>show_labels</code> so the set names can be displayed outside.</p></li>
<li><p>Store <code>item_cex</code> and <code>item_buffer</code> somehow for re-use, otherwise <code>plot(venndir_out)</code> does not retain these settings.</p></li>
<li><p>Improve the default adjustment to <code>item_buffer</code> based upon number of items, and relative size of the polygon. With fewer items (2 or 1), it should more sharply use the center position.</p></li>
<li><p>Consider option to justify item label based upon its left-right position in the polygon. Item labels on left edge would be placed so the left edge of the label aligns with the left edge of the polygon. It could help reduce labels overlapping the outside of a polygon. It might make labels more crowded inside the polygon.</p></li>
<li><p>Consider some option to reduce item label overlaps.</p></li>
<li><p>Consider some approach to place count label box inside the polygon, with item labels around it? Probably not feasible.</p></li>
<li><p>Useful test case, to reproduce a published figure. Note that <code>as_factor()</code> does not affect item sorting, only the numeric prefix seems to work.</p></li>
</ul><pre><code><span><span class="va">as_factor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">x</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">venndir</span><span class="fu">::</span><span class="fu"><a href="reference/venn_meme.html">venn_meme</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>   CLE<span class="op">=</span><span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 CLE:"</span>,</span>
<span>      <span class="st">"2 IFNa&gt;IFNb"</span>,</span>
<span>      <span class="st">"3 Anti-malarials effective\ntherapy for skin disease"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   DM<span class="op">=</span><span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1 DM:"</span>,</span>
<span>      <span class="st">"2 IFNb&gt;IFNa"</span>,</span>
<span>      <span class="st">"\n3 Triggered by immune\nstimulating herbal\nsupplements"</span>,</span>
<span>      <span class="st">"\n\n\n4 Anti-malarials effective\nin 25%, commonly causes\nmorbilliform rash"</span>,</span>
<span>      <span class="st">"\n\n\n\n5 Cannabinoid receptor\nagonist proising\ntreatment"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   `CLE&amp;DM`<span class="op">=</span><span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"1 Photosensitivity"</span>,</span>
<span>      <span class="st">"2 Triggered by viral and\nbacterial infections"</span>,</span>
<span>      <span class="st">"3 Increased\ntype I IFN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   item_cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>   xyratio<span class="op">=</span><span class="fl">10</span>,</span>
<span>   dither_cex<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre>
</li>
</ul></div>
<div class="section level2">
<h2 id="id_13sep2024">13sep2024<a class="anchor" aria-label="anchor" href="#id_13sep2024"></a></h2>
<ul><li>
<p>Adjust aesthetics based upon feedback.</p>
<ul><li><p>The arrows could be larger relative to the signed counts.</p></li>
<li><p>Consider removing the colon <code>":"</code> between arrows and signed counts.</p></li>
<li>
<p>When adjusting arrow/signed count font sizes, the text is bottom-aligned, should probably be middle (top-middle-bottom) aligned.</p>
<ul><li>Using <code>vjust=0.5</code> caused signed labels not to be grouped properly.</li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_04sep2024">04sep2024<a class="anchor" aria-label="anchor" href="#id_04sep2024"></a></h2>
<ul><li>Fix bug when <code>names(setlist)</code> contains parentheses, causing the set name to appear inside the polygon. Removing the parentheses fixes the problem, but unclear why this happens? Probably errant <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep()</a></code> call somewhere.</li>
</ul></div>
<div class="section level2">
<h2 id="id_28aug2024">28aug2024<a class="anchor" aria-label="anchor" href="#id_28aug2024"></a></h2>
<ul><li><p>Need some way to move outside labels to the top (or bottom), the default makes labels wide, which is difficult to use in figures.</p></li>
<li><p>Need some way to nudge count labels, to adjust centering polygons.</p></li>
<li><p>Consider using <code>cli</code> for messaging, and for unicode symbol support?</p></li>
<li><p>Hide single-set signed labels with concordance and agreement</p></li>
<li>
<p>Add generic convenience functions</p>
<ul><li>
<code>im()</code>, <code>im_value()</code> for <code>Venndir</code> objects: return incidence matrix, or signed-incidence matrix.</li>
<li>
<code>setlist()</code> - accessor for <code>setlist</code>
</li>
<li>
<code>label_df()</code> - accessor for <code>label_df</code>
</li>
<li>
<code>overlaps()</code> or <code>get_overlaps()</code> - some accessors for set overlaps</li>
</ul></li>
<li><p><code><a href="reference/nudge_JamPolygon.html">nudge_JamPolygon()</a></code> - extend with <code>scale</code>, <code>rotation</code>.</p></li>
<li>
<p>Consider <code>item_style</code> with similar presets as <code>label_style</code>.</p>
<ul><li>Use case is to allow shading/border for item labels, <code><a href="reference/venndir.html">venndir()</a></code> and <code><a href="reference/venn_meme.html">venn_meme()</a></code>.</li>
</ul></li>
<li>
<p>Consider adding validation for <code>Venndir</code></p>
<ul><li>Probably only necessary when editing <code>jps</code> and <code>label_df</code>, which may be rare</li>
<li>Check that <code>label_df</code> and <code>jps</code> are compatible</li>
</ul></li>
<li>
<p>Consider <code><a href="reference/signed_overlaps.html">signed_overlaps()</a></code> S4 object?</p>
<ul><li>Currently returns <code>data.frame</code> - usable but due to the fixed formatting. Could be useful to “lock it down” to add validation checks, and to provide convenience functions.</li>
<li>Probably not worth the effort yet.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_22aug2024">22aug2024<a class="anchor" aria-label="anchor" href="#id_22aug2024"></a></h2>
<ul><li>
<p>Enhance <code><a href="reference/venndir_to_df.html">venndir_to_df()</a></code></p>
<ul><li>
<p>Add two additional formats:</p>
<ol style="list-style-type: decimal"><li>Venn item format, one column for each overlap, with list of items in each column. This is “user-convenient” and easy way to find a list of items without having to filter the table.</li>
<li>Hit format, with item rows, and one column for each <code>setlist</code> entry, with values <code>-1</code> or <code>1</code> indicating presence of that item. This format is programmatically easier to use, but requires some filtering of the table to find particular overlaps.</li>
</ol></li>
<li><p>Consider changing <code>return_type="data.frame"</code>, with <code>"kable"</code> optional.</p></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_20aug2024">20aug2024<a class="anchor" aria-label="anchor" href="#id_20aug2024"></a></h2>
<ul><li>
<p>Convert from <code>vwline</code> to <code>gridGeometry</code>, per pmur002 (author of both)</p>
<ul><li>Initial testing confirms it should work.</li>
<li>Polygon offset is explained in detail here: <a href="https://www.stat.auckland.ac.nz/~paul/Reports/Geometry/offset/offset.html" class="external-link uri">https://www.stat.auckland.ac.nz/~paul/Reports/Geometry/offset/offset.html</a>
</li>
<li>gridGeometry explained here: <a href="https://www.stat.auckland.ac.nz/~paul/Reports/Geometry/gridgeometry/gridgeometry.html" class="external-link uri">https://www.stat.auckland.ac.nz/~paul/Reports/Geometry/gridgeometry/gridgeometry.html</a>
</li>
<li>Useful functions: <code>polyoffsetGrob()</code> - use <code>rule="evenodd"</code>
</li>
</ul></li>
<li>
<p>Consider formally recognizing three types of border:</p>
<ul><li>
<code>outerborder</code> - only appears outside the polygon boundary</li>
<li>
<code>innerborder</code> - only appears inside the polygon boundary</li>
<li>
<code>border</code> - appears exactly on the polygon boundary, default <code>NA</code>
</li>
<li>each use suffix parameters: <code>.lwd</code>, <code>.lty</code>
</li>
<li>requires changing <code><a href="reference/venndir.html">venndir()</a></code> to use <code>outerborder</code> and not <code>border</code>.</li>
</ul></li>
<li><p>Consider customizable <code>digits</code> for percent overlap label.</p></li>
<li>
<p><code><a href="reference/textvenn.html">textvenn()</a></code> quality of life</p>
<ul><li>Accept optional input data in <code>...</code> for convenience</li>
<li>Add option to display percent overlap</li>
<li>Consider using something like <code>show_labels</code>
</li>
</ul></li>
<li>
<p>Consider adding example test cases:</p>
<ul><li>Venn diagram labeled by gene symbol. Cho et al 2019, <a href="https://doi.org/10.1073/pnas.1919528117" class="external-link uri">https://doi.org/10.1073/pnas.1919528117</a> Figure 5A: Venn diagram showing +/-rapamycin ER-mito proteome. Genes are also colorized and highlighted, it might be too much as a visual, but is possible to replicate. It shows item labels outside the Venn diagram which may be useful <code>venndir</code> feature in future.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_01aug2024">01aug2024<a class="anchor" aria-label="anchor" href="#id_01aug2024"></a></h2>
<ul><li>
<p>Consider adding argument <code>title</code> or <code>main</code> to add a title to the figure.</p>
<ul><li>Define title as a <code>grob</code> that can be manipulated if needed.</li>
<li>The <code>grob</code> follows the figure, so multi-panel figures retain the title relative to each figure.</li>
<li>Consider options for placement: top, top-left, bottom, etc.; and text alignment options: <code>just</code>, <code>hjust</code>, <code>vjust</code>.</li>
<li>It may need its own simple wrapper function <code>venndir_title()</code> to hold these options, with useful defaults. It simply returns a <code>grob</code>.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_29jul2024">29jul2024<a class="anchor" aria-label="anchor" href="#id_29jul2024"></a></h2>
<ul><li><p>Consider <code>clisymbols</code> to handle logic of Unicode arrow symbols.</p></li>
<li><p>Consider option not to sort item labels, which would allow user control over the order when displayed in the Venn diagram.</p></li>
<li>
<p>Document some “fancy” examples showing item labels:</p>
<ul><li>One-column item layout.</li>
<li>Control over font sizes/colors via <code>gridtext</code> syntax.</li>
<li>Try examples using short text phrases as “items” in each overlap region.</li>
<li>Use of image instead of text label. It can be a mix of images and labels, using <code>gridtext</code> features.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_24jul2024">24jul2024<a class="anchor" aria-label="anchor" href="#id_24jul2024"></a></h2>
<ul><li>
<p>Customize item fill logic</p>
<ul><li><p>Generally spread labels more to the center.</p></li>
<li><p>Note: <code>xyratio</code> argument to <code><a href="reference/label_fill_JamPolygon.html">label_fill_JamPolygon()</a></code> is passed, but high values <code>xyratio=10</code> cause labels to be placed too far at the top.</p></li>
<li>
<p>Consider new rules:</p>
<ul><li>When more positions are produced than required, evenly distribute labels across that array of positions.</li>
</ul></li>
</ul></li>
<li>
<p>Consider improving how percent overlap is handled</p>
<ul><li><p>Currently appends to the <code>"text"</code> column.</p></li>
<li><p>Undesired outcome: percent overlap uses the same font size as the count. It could use slightly smaller font, or same font size as signed counts.</p></li>
<li><p>It does not permit custom styling, fontsize, fontface, and only currently permits percent overlap.</p></li>
<li><p>Examples for optional style: <code>"(24%)"</code> <code>"(24%) J:0.24"</code></p></li>
<li><p>It could permit optional metrics: Jaccard overlap, concordance coefficient</p></li>
<li>
<p>Consider adding column to include the label.</p>
<ul><li>Jaccard.overlap=0.7</li>
<li>Concordance.overlap=0.45</li>
<li>{Name}.overlap=#</li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_18jul2024">18jul2024<a class="anchor" aria-label="anchor" href="#id_18jul2024"></a></h2>
<ul><li>
<p>Add documentation. Here is a laundry list of tips:</p>
<ul><li><p>Show examples with DESeq2 results; edgeR; limma.</p></li>
<li><p>Show how to import a list from a file.</p></li>
<li><p>Describe that the output is <code><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grid::gTree</a></code> which can be drawn separately.</p></li>
<li><p>Show how to draw two Venn diagrams in one figure using <code>patchwork</code>, for example, do this twice, then add the results: <code>patchwork::wrap_elements(grid::grid.draw(attr(vo, "gtree")))</code></p></li>
<li><p>Show how to change the setlist labels (as displayed in the figure), and legend labels (as displayed in the legend).</p></li>
<li><p>Show how to adjust the figure size to prevent overlap with legend.</p></li>
<li><p>Show how to adjust font sizes, legend font size, legend row padding.</p></li>
<li><p>Show how to supply custom colors.</p></li>
<li><p>Show how colors can be defined for 8 sets, then display only a subset, so the colors are consistent for each set displayed.</p></li>
<li><p>Show how to convert input from hit matrix to setlist.</p></li>
<li><p>Show how to convert input from overlap counts to setlist.</p></li>
<li><p>Show how to convert input from signed overlap counts to setlist, more complicated, can be useful when reproducing a figure.</p></li>
<li><p>Show how to nudge proportional circles during <code><a href="reference/venndir.html">venndir()</a></code> call.</p></li>
<li><p>Show how to display all labels inside, outside, or signed/count labels inside/outside - with and without item labels.</p></li>
<li><p>Show how to include percent overlap labels.</p></li>
<li><p>Show how to move an outside label manually.</p></li>
<li><p>Show how to supply a custom set of <code>JamPolygon</code> shapes instead of using pre-defined fixed shapes, or shapes from <code><a href="https://jolars.github.io/eulerr/reference/eulerr-package.html" class="external-link">eulerr::eulerr()</a></code>.</p></li>
<li><p>Show how to set <code>shape="ellipse"</code> with proportional diagrams.</p></li>
<li><p>Show effect of <code>set.seed(123)</code> for reproducibility.</p></li>
<li><p>Show how to customize <code><a href="reference/curate_venn_labels.html">curate_venn_labels()</a></code> to use customized “signs”.</p></li>
<li>
<p>Show how to extract items for each overlap.</p>
<ul><li>Placeholder:</li>
</ul><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">itemlist_by_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">vns</span><span class="op">@</span><span class="va">label_df</span><span class="op">$</span><span class="va">items</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">vns</span><span class="op">@</span><span class="va">label_df</span><span class="op">$</span><span class="va">overlap_set</span>,</span>
<span>      levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">vns</span><span class="op">@</span><span class="va">label_df</span><span class="op">$</span><span class="va">overlap_set</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
<li><p>Show how to make an incidence matrix; or signed incidence matrix.</p></li>
</ul></li>
<li>
<p>Add R package integration functions</p>
<ul><li><p>Probably most useful to integrate packages that produce setlist data, or to Upset plots for people who also prefer that functionality. Probably less useful to integrate with other Venn diagram packages.</p></li>
<li>
<p><code>stats_to_hitlist()</code> - consider generic function to convert stats table to signed hits - generic function could be re-used for package-specific:</p>
<ul><li>
<code>DESeq_to_hitlist()</code> - consider converting DESeq2 results to hits</li>
<li>
<code>topTable_to_hitlist()</code> - convert <code><a href="https://rdrr.io/pkg/limma/man/toptable.html" class="external-link">limma::topTable()</a></code>
</li>
<li><code>edgeR_to_hitlist()</code></li>
</ul></li>
<li>
<p><code>ChIPpeakAnno()</code> integration with <code>makeVennDiagram()</code></p>
<ul><li>It optionally includes labels with enrichment ratios</li>
</ul></li>
<li><p><code>to_VennDetail()</code></p></li>
<li><p><code>to_ggVennDiagram()</code></p></li>
<li><p><code>to_VennDiagram()</code></p></li>
<li><p><code>to_UpsetR()</code> - send data to create an Upset plot</p></li>
<li><p><code>to_venn()</code> - send data to <code>venn</code> package</p></li>
<li><p><code>to_RVenn()</code> - send data to <code>RVenn</code> package</p></li>
</ul></li>
<li>
<p>Add remaining small features</p>
<ul><li>
<code><a href="reference/venndir.html">venndir()</a></code> argument <code>rotate_degrees</code> is not yet functional.</li>
<li>
<code><a href="reference/venndir.html">venndir()</a></code> add argument to control line width</li>
<li>Consider <code>launch_venndir_shiny()</code> with R-Shiny front-end.</li>
</ul></li>
<li>
<p>Consider JamPolygons using <code>outerborder</code> instead of <code>border</code></p>
<ul><li>Methods currently assume all borders are <code>outerborder</code>, the other option is <code>innerborder</code>. This was a design decision, might need to change. If there is need to display just a <code>border</code> (not inner, not outer) on the line itself, there is not a mechanism to do so currently.</li>
<li>Need changes to <code><a href="reference/find_venn_overlaps_JamPolygon.html">find_venn_overlaps_JamPolygon()</a></code> and <code><a href="reference/venndir.html">venndir()</a></code> to use <code>outerborder</code> instead of <code>border</code>.</li>
<li>Need changes to <code><a href="reference/plot.JamPolygon.html">plot.JamPolygon()</a></code> to use <code>border</code> instead of thin border, and <code>outerborder</code> instead of <code>border</code>.</li>
</ul></li>
<li>
<p>Investigate R crash - probably specific to Quartz on MacOS Sonoma 14.4, 14.5</p>
<ul><li>Reproducible workflow in RStudio:</li>
</ul><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jmw86069.github.io/venndir">venndir</a></span><span class="op">)</span></span>
<span><span class="va">vo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/venndir.html">venndir</a></span><span class="op">(</span><span class="fu"><a href="reference/make_venn_test.html">make_venn_test</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">3</span>, do_signed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, show_labels<span class="op">=</span><span class="st">"ncs"</span><span class="op">)</span></span>
<span><span class="co"># open new device</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># this time crashes</span></span>
<span><span class="va">vo</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/venndir.html">venndir</a></span><span class="op">(</span><span class="fu"><a href="reference/make_venn_test.html">make_venn_test</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">3</span>, do_signed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, show_labels<span class="op">=</span><span class="st">"ncs"</span><span class="op">)</span></span></code></pre></div>
<ul><li>The crash occurs inconsistently from separate R console, same workflow. The console prints this crash message: <code>"Fatal error: Duplicate keys of type 'DisplayList' were found in a Dictionary."</code>
</li>
<li>Topic online suggests the error is linked with MacOS Sonoma 14.4, 14.5. <a href="https://stackoverflow.com/questions/78615561/fatal-error-duplicate-keys-of-type-displaylist-were-found-in-a-dictionary" class="external-link uri">https://stackoverflow.com/questions/78615561/fatal-error-duplicate-keys-of-type-displaylist-were-found-in-a-dictionary</a>
</li>
<li>The crash occurs with venndir-0.0.34.900, and venndir-0.0.36.900, suggesting the risk was not added by updates in 0.0.36.900. Therefore version 0.0.36.900 will be released once it passes other tests.</li>
</ul></li>
<li>
<p><code><a href="reference/venndir_legender.html">venndir_legender()</a></code></p>
<ul><li>Currently it is drawn using the plot viewport. But when drawn after the viewport is closed (<code><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">grid::popViewport()</a></code>) the legend appears at the edge of the figure region, which can be outside the venndir plot. Consider option for the legend to use the figure viewport and not the venndir plot viewport.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_15jul2024">15jul2024<a class="anchor" aria-label="anchor" href="#id_15jul2024"></a></h2>
<ul><li>
<p>Prepare for Bioconductor (or CRAN)</p>
<ul><li>
<p>DONE. Remove any calls to internal package functions, using <code>:::</code></p>
<ul><li>
<code>gridtext_richtext_grob()</code> is a custom function, must be removed. It calls internal functions in <code>gridtext</code> that can’t be ported easily, for example <code><a href="https://rdrr.io/r/base/CallExternal.html" class="external-link">.Call()</a></code>. The custom function was solely intended to allow vectorized <code>padding</code>, currently the bottom,left,top,right is applied to all labels, and cannot be custom for each label. The driving goal was to have smaller margins between signed count labels, since they usually have smaller font size. Otherwise the distance between signed labels, line-by-line, was too far. First option, just call <code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code> and remove the ability to use different padding. Second option, wrap the call inside <code><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply()</a></code> which is what is done inside gridtext for multiple grobs anyway. It won’t be any slower. Final option is to ask Dr. Claus Wilke to allow a list of vectors as input for argument <code>padding</code>.</li>
</ul></li>
</ul></li>
<li>
<p><code><a href="reference/plot.JamPolygon.html">plot.JamPolygon()</a></code></p>
<ul><li>DONE. Consider option to return grid grobs instead of drawing them to the graphical device.</li>
</ul></li>
<li>
<p><code><a href="reference/render_venndir.html">render_venndir()</a></code>, and <code><a href="reference/venndir.html">venndir()</a></code></p>
<ul><li>DONE. Consider option to return the grid grobs to be rendered elsewhere. Return the <code>viewport</code> as defined by <code><a href="reference/plot.JamPolygon.html">plot.JamPolygon()</a></code>.</li>
<li>DONE. Consider something like post plot hook, to call a function after the plot is rendered, before calling <code><a href="https://rdrr.io/r/grid/grid-defunct.html" class="external-link">grid::pop.viewport()</a></code>. (Note: “DONE” means this functionality is possible, but because the <code>grid</code> grobs make it possible for the user to do whatever they want.)</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_09jul2024">09jul2024<a class="anchor" aria-label="anchor" href="#id_09jul2024"></a></h2>
<ul><li>DONE. Fix bug where <code>sets</code> is properly subsetting <code>setlist</code> but is not properly subsetting <code>set_colors</code>. Verify other components are also properly subset as needed.</li>
</ul></div>
<div class="section level2">
<h2 id="id_08jul2024">08jul2024<a class="anchor" aria-label="anchor" href="#id_08jul2024"></a></h2>
<ul><li><p>Currently <code><a href="reference/venndir.html">venndir()</a></code> does not store <code>item_cex</code> and <code>item_buffer</code> in the <code>Venndir</code> object, so calling <code><a href="reference/render_venndir.html">render_venndir()</a></code> does not retain these values.</p></li>
<li>
<p>Consider functions to adjust components of <code>Venndir</code> figure, to be visualized by <code><a href="reference/render_venndir.html">render_venndir()</a></code>.</p>
<ul><li>
<p>Nudge outer label position by set name, or <code>overlap_set</code></p>
<ul><li>When provided a value that matches <code>"label_df$ref_polygon"</code>, it should affect all rows with that value.</li>
<li>When provided a value that does not match <code>"label_df$ref_polygon"</code>, it should look for corresponding value in <code>"label_df$name"</code> or <code>"label_df$venn_name"</code>, then convert to <code>"label_df$ref_polygon"</code>. Then proceed to update all rows with that <code>ref_polygon</code> value.</li>
</ul></li>
<li><p>Nudge inner label position, same syntax as above.</p></li>
<li>
<p>Nudge a set shape (This workflow is lower priority for now.) Best practice is to re-run <code><a href="reference/venndir.html">venndir()</a></code> using argument <code>circle_nudge</code>.</p>
<ul><li>Second-best is a wrapper function that extracts data from <code>Venndir</code> and just calls <code><a href="reference/venndir.html">venndir()</a></code> with corresponding arguments. It should capture: <code>JamPolygons</code> for each set; <code>set_colors</code>; <code>setlist_labels</code>, <code>legend_labels</code>, <code>sets</code>, etc.</li>
</ul></li>
</ul></li>
<li><p>Consider option to style item labels. Probably most useful for <code><a href="reference/venn_meme.html">venn_meme()</a></code>. For example, allow shading, rounded rectangle border, as with set labels.</p></li>
</ul></div>
<div class="section level2">
<h2 id="id_25jun2024">25jun2024<a class="anchor" aria-label="anchor" href="#id_25jun2024"></a></h2>
<ul><li>
<p>Fix bugs with proportional diagrams:</p>
<ul><li><p>One empty set in <code>setlist</code> causes an error.</p></li>
<li><p>One set fully encompassed inside another set causes the set label to be hidden.</p></li>
<li>
<p>The two bugs are related:</p>
<ul><li>The “set label” is assigned to appear where there is a unique “overlap_set” - for example “set_A” should appear where there is “set_A” unique overlaps that do not overlap another set.</li>
<li>This condition is always valid for Venn diagrams.</li>
<li>For proportional diagrams, sometimes “set_A” is fully inside “set_B”. We could call these “orphan set labels”.</li>
<li>Previously the label “set_A” was associated with <code>overlap_set="set_A&amp;set_B"</code>.</li>
<li>This set label also used its own outside label position, the goal was to allow potentially showing the set label “set_A”, distinct from the overlap label “set_A&amp;set_B”, both pointing to “set_A&amp;set_B”.</li>
<li>Visually it could be confusing, when count labels were displayed outside - there were two labels pointing to the same polygon region.</li>
<li>The logic to assign an “orphan set label” to the best available overlap set also occurred in multiple functions, nothing was stored in the <code>Venndir</code> object to review this assignment.</li>
<li>Finally, the collection of labels which should appear together was complicated because the label position <code>hjust_inside</code>, <code>hjust_outside</code>, <code>vjust_inside</code>, <code>vjust_outside</code> relied upon knowing which labels were being placed together, and this logic failed.</li>
</ul></li>
<li>
<p>The fix (fixes):</p>
<ul><li><p>Associate set label to <code>"ref_polygon"</code> and store in <code>Venndir@jps</code>.</p></li>
<li><p>Update <code><a href="reference/render_venndir.html">render_venndir()</a></code> to recognize this association, instead of re-determining the association.</p></li>
<li><p>Update <code><a href="reference/venndir_label_style.html">venndir_label_style()</a></code> to recognize this association so it can properly assign <code>hjust</code> and <code>vjust</code> to affected labels. This function is one feasible place to make the changes.</p></li>
<li>
<p>Another alternative <code>draw_gridtext_groups()</code> which assembles the grouped labels into a “group” in order to draw one border around them. This step may be ideal to place labels together in more flexible ways.</p>
<ul><li>Labels are laid out within active <code>grid</code> viewport context, then the observed dimensions in <code>grid</code> space are used to define the extent of the resulting <code><a href="https://rdrr.io/r/grid/grid.roundrect.html" class="external-link">grid::roundrectGrob()</a></code>.</li>
<li>This step optionally re-centers the group of labels when <code>adjust_center=TRUE</code>, so the center of the group is at the label point, instead of the focal point of labels (normally the set name is “topleft”, the overlap count is “bottomleft”, and signed counts are “right”).</li>
<li>This function could provide a convenient way to assemble labels without having to rely upon <code>hjust</code> and <code>vjust</code>.</li>
<li>This function could also enable different layouts, like set label at the top, counts at the bottom; set label at the top, then counts bottomleft and signed counts bottomright.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Fix <code><a href="reference/venndir.html">venndir()</a></code> argument <code>rotate_degrees</code> which is currently not functioning.</p></li>
<li>
<p>Consider minor adjustments to <code><a href="reference/venndir_legender.html">venndir_legender()</a></code> labeling.</p>
<ul><li>Option to hide the trailing colon <code>":"</code>
</li>
<li>Option to left-justify set labels</li>
</ul></li>
<li>
<p>Consider returning the <code>viewport</code> from <code><a href="reference/render_venndir.html">render_venndir()</a></code>, and <code><a href="reference/venndir.html">venndir()</a></code> when it calls <code><a href="reference/render_venndir.html">render_venndir()</a></code> due to <code>do_plot=TRUE</code>.</p>
<ul><li>consider adding as an attribute of the <code>Venndir</code> object</li>
<li>the <code>grid</code> <code>viewport</code> is useful when adding to or adjusting an existing figure, otherwise the coordinate system is not usable.</li>
</ul></li>
<li><p>Write more intensive validation for <code>Venndir</code> objects.</p></li>
<li><p>Consider option for black-and-white legend.</p></li>
<li><p>Write vignette with larger variety of examples for <code><a href="reference/venndir.html">venndir()</a></code></p></li>
<li><p>Expand help docs for <code>JamPolygon</code></p></li>
<li><p>Write brief vignette for <code>JamPolygon</code> objects</p></li>
<li>
<p>Tests for <code>JamPolygon</code> object functions</p>
<ul><li>generate test shapes: circle, circle with hole (donut), two disjoin squares, square with hole and nested square inside the hole.</li>
<li>
<code><a href="reference/point_in_JamPolygon.html">point_in_JamPolygon()</a></code>, <code><a href="reference/has_point_in_JamPolygon.html">has_point_in_JamPolygon()</a></code> points in the polygon, in the hole, in the nested internal solid area.</li>
<li>
<code><a href="reference/labelr_JamPolygon.html">labelr_JamPolygon()</a></code> to generate label position inside solid polygon, also test with <code><a href="reference/has_point_in_JamPolygon.html">has_point_in_JamPolygon()</a></code>
</li>
<li>
<code><a href="reference/nearest_point_JamPolygon.html">nearest_point_JamPolygon()</a></code>, <code><a href="reference/farthest_point_JamPolygon.html">farthest_point_JamPolygon()</a></code> to confirm proper nearest/farthest points.</li>
<li>
<code><a href="reference/intersect_JamPolygon.html">intersect_JamPolygon()</a></code>, <code><a href="reference/union_JamPolygon.html">union_JamPolygon()</a></code>, <code><a href="reference/minus_JamPolygon.html">minus_JamPolygon()</a></code>
</li>
<li>
<code><a href="reference/buffer_JamPolygon.html">buffer_JamPolygon()</a></code> - confirm polygon with hole can become larger polygon without a hole. Probably check <code><a href="reference/area_JamPolygon.html">area_JamPolygon()</a></code> before/after several use cases.</li>
</ul></li>
<li>
<p>Consider moving <code>JamPolygon</code> to a separate R package.</p>
<ul><li>Painful but might make <code>JamPolygon</code> a lightweight standalone option, usable in other Jam packages (without guilt).</li>
<li>Dependencies: polyclip, polylabelr, vwline</li>
</ul></li>
<li>
<p>Consider adding <code>JamPoints</code>, <code>JamLines</code> objects? Ugh. What have I done?</p>
<ul><li>There is currently no way to “Add a point” to a <code>JamPolygon</code> figure, since the figure is created in <code>grid</code> using a <code>viewport</code>.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_22jun2024">22jun2024<a class="anchor" aria-label="anchor" href="#id_22jun2024"></a></h2>
<ul><li><p>DONE. Consider changing default to <code>do_sparse=FALSE</code> so the default behavior is to return a typical <code>matrix</code> class and not <code>Matrix</code> compressed form.</p></li>
<li><p>DONE. Consider removing <code>matrixStats</code> from dependencies, it is only used once.</p></li>
<li><p>DONE. Add examples to <code><a href="reference/rescale_coordinates.html">rescale_coordinates()</a></code>.</p></li>
<li><p>DONE. Fix <code>alpha_by_counts=TRUE.</code></p></li>
<li>
<p>DONE. Consider optional labels for <code>Venndir</code></p>
<ul><li>
<code>setlist_labels</code> - optional user-customized labels for the Venn diagram, which may or may not match the name of the set.</li>
<li>
<code>legend_labels</code> - optional user-customized labels for the Venn legend, again, these may be abbreviated or adjusted to be suitable for the legend.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_18jun2024">18jun2024<a class="anchor" aria-label="anchor" href="#id_18jun2024"></a></h2>
<ul><li>
<p>Outer label positions and line segments should be improved.</p>
<ul><li>Sometimes the outer label is across the diagram from the count label, the line segment reaches to the far side. Test with nested proportional set Venn.</li>
<li>should be influenced by the position of the relevant count label.</li>
</ul></li>
<li><p>Consider whether to include percent in the Venndir legend.</p></li>
<li><p>Consider an option to include percent in <code><a href="reference/textvenn.html">textvenn()</a></code> output. It would appear on the line below the overlap count.</p></li>
<li><p>Consider allowing vectorized <code>show_labels</code> to be applied to each overlap in order.</p></li>
</ul></div>
<div class="section level2">
<h2 id="id_12jun2024">12jun2024<a class="anchor" aria-label="anchor" href="#id_12jun2024"></a></h2>
<ul><li><p>DONE. <code><a href="reference/render_venndir.html">render_venndir()</a></code> - broken when provided with <code><a href="reference/venndir.html">venndir()</a></code> output separately.</p></li>
<li>
<p>DONE. <code><a href="reference/venn_meme.html">venn_meme()</a></code> - some visual adjustments are needed</p>
<ul><li>DONE. Fix regression in <code>gridtext</code>, item labels do not recognize <code>&lt;br&gt;</code>.</li>
<li>Center item labels in the polygon for few number of items (especially one). Current state: item label is placed near edges and not in the center. Current state: <code>item_buffer</code> is the best way to adjust manually. DONE for <code><a href="reference/venn_meme.html">venn_meme()</a></code> not for general use.</li>
</ul></li>
<li><p>DONE. Label segment for nested, nested sets, uses the full set as fallback. Ideally, it would use the region with the fewest overlaps with other areas.</p></li>
</ul></div>
<div class="section level2">
<h2 id="id_11jun2024">11jun2024<a class="anchor" aria-label="anchor" href="#id_11jun2024"></a></h2>
<ul><li>
<p>DONE. <code><a href="reference/venndir.html">venndir()</a></code> error</p>
<ul><li>Error is caused when two sets do not overlap, and <code>proportional=TRUE</code>. See <code><a href="reference/find_venn_overlaps_JamPolygon.html">find_venn_overlaps_JamPolygon()</a></code> in venndir-base-polyclip.R#428 <code><a href="reference/intersect_JamPolygon.html">intersect_JamPolygon()</a></code> in venndir-polyclip.R#245.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_02may2024">02may2024<a class="anchor" aria-label="anchor" href="#id_02may2024"></a></h2>
<ul><li>
<p><code><a href="reference/venndir_legender.html">venndir_legender()</a></code></p>
<ul><li>Use “Set” and “Size” capitalized.</li>
<li>Left-align text in “Set” column; right-align numbers in “Size”.</li>
<li>Consider option not to colorize the table rows.</li>
<li>Consider adding a column “Color” with filled cell. Bonus points for having the color be a perfect square (not rectangular).</li>
<li>Apply contrasting color, when rows are filled with <code>set_colors</code>, currently text is always black.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_23apr2024">23apr2024<a class="anchor" aria-label="anchor" href="#id_23apr2024"></a></h2>
<ul><li>
<p><code><a href="reference/plot.JamPolygon.html">plot.JamPolygon()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> (JamPolygon)</p>
<ul><li>Allow and document how to create a multi-panel plot. For example, how can it be used with <code>patchwork</code> to assemble a Venn diagram beside a heatmap, or beside output from <code>plot_sedesign()</code>?</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_22apr2024">22apr2024<a class="anchor" aria-label="anchor" href="#id_22apr2024"></a></h2>
<ul><li>
<p><code><a href="reference/render_venndir.html">render_venndir()</a></code> throws font-related warnings when the output PNG or PDF font library is not found, and sometimes substitutes Unicode characters with <code>"."</code>. It seems to happen uniquely to PDF output, might be platform- and device-dependent. Some suggested workarounds include:</p>
<ul><li>Use <code>extrafonts</code> package to import the desired fonts. Not tested.</li>
<li>Use specific <code>fontfamily</code> which is recognized for the requested output, however in RMarkdown when creating PNG and PDF files for the same chunk, it appears that the PNG and PDF recognized fonts are not consistent.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_22mar2024">22mar2024<a class="anchor" aria-label="anchor" href="#id_22mar2024"></a></h2>
<ul><li><p>Remove all “sp”,<code>sf</code>,“rgeos” functions</p></li>
<li>
<p>Remove all portions of remaining functions that call “sp”,<code>sf</code>,“rgeos”</p>
<ul><li>
<code>polygon_label_segment()</code> - still uses a hybrid approach, accepting sp and jp objects.</li>
</ul></li>
<li>
<p>Verify the new <code><a href="reference/venndir.html">venndir()</a></code> returns equivalent data as <code>venndir_OLD()</code> even if it is returned in different manner.</p>
<ul><li>Clean up output data format</li>
</ul></li>
<li><p>Verify <code>render_venndir_polyclip()</code> accepts equivalent input data.</p></li>
<li><p>Consider making <code><a href="reference/venndir.html">venndir()</a></code> output equivalent to previous versions, so that methods that expect specific output might still work?</p></li>
<li>
<p>Consider S4 <code>Venndir</code> object, with slot names:</p>
<ul><li>
<p>slots:</p>
<ul><li>
<code>jp</code> - set polygons, name, label, color</li>
<li>
<code>jps</code> - set/overlap polygons, name, label, type, overlap</li>
<li>
<code>label_df</code> - overlap count, signed count, count label, items (optional)</li>
<li>
<code>setlist</code> - the input <code>setlist</code> for easy reference</li>
</ul></li>
<li>
<p>methods:</p>
<ul><li>
<p><code>validate()</code> - check internal consistency, set names, overlaps, label xy</p>
<ul><li>names(setlist) matches names(jp), are found in names(jps)</li>
<li>jps overlap names -&gt; set names -&gt; found in names(setlist), names(jp)</li>
<li>label_df overlap names all present in jps overlap names</li>
<li>label_df specific overlap count sum equals jps overlap count</li>
</ul></li>
<li><p><code>setlist()</code> - accessor for <code>setlist</code> slot</p></li>
<li><p><code>im()</code> - calls <code><a href="reference/list2im_opt.html">list2im_opt()</a></code></p></li>
<li><p><code>im_signed()</code> (or <code>im_value()</code>) - calls <code><a href="reference/list2im_value.html">list2im_value()</a></code></p></li>
<li><p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> - calls <code><a href="reference/render_venndir.html">render_venndir()</a></code></p></li>
</ul></li>
</ul></li>
<li>
<p>label positioning shorthand: NOCPSI</p>
<ul><li>Set _N_ame, _O_verlap Name, _C_ount, _P_ercentage, _S_igned, _I_tems</li>
<li>uppercase is “outside”, lowercase is “inside” the relevant polygon</li>
<li>Default: Ncps: set _N_ame outside; _c_ount/_s_igned inside, others hidden</li>
<li>To show items: NCSi: _N_ame/_C_ount/_S_igned outside; items inside</li>
</ul></li>
<li>
<p>consider table item display inside/outside</p>
<ul><li>
<code><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">gridExtra::tableGrob()</a></code> with 1 to 3 columns, which could be positioned beneath other name/count labels. Seen in published Venn diagram figure. Probably only works well for a small number of items.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_13mar2024">13mar2024<a class="anchor" aria-label="anchor" href="#id_13mar2024"></a></h2>
<ul><li><p>Optionally display overall percentage below main count label.</p></li>
<li>
<p>Consider <code>JamPolygon</code> which is a <code>data.frame</code>:</p>
<ul><li>
<p><code>data.frame</code> details:</p>
<ul><li><p>Each row is strictly one polygon, multipart polygons are still one row.</p></li>
<li><p><code>x</code>: <code>list</code> column with one or more <code>numeric</code> vectors.</p></li>
<li><p><code>y</code>: <code>list</code> column with one or more <code>numeric</code> vectors.</p></li>
<li><p><code>name</code> - unique entry, essentially <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames()</a></code></p></li>
<li>
<p><code>label</code> - by default uses <code>name</code> but can be anything including <code>NA</code>, also it can contain the same label as another polygon.</p>
<ul><li>Unclear whether it can store <code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code>?</li>
</ul></li>
<li><p><code>labels</code> - optional, label each multipart polygon - not implemented yet</p></li>
<li><p><code>fill</code> - internal polygon fill color</p></li>
<li>
<p><code>border</code>, <code>border.lwd</code>, <code>border.lty</code> - outer border</p>
<ul><li>Consider R package <code>vwline</code> for variable width lines, part of which enables rendering the outer/inner portion of a line.</li>
</ul></li>
<li><p><code>innerborder</code>, <code>innerborder.lwd</code>, <code>innerborder.lty</code> - inner border</p></li>
<li><p><code>family</code>, <code>fontsize</code> - <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar()</a></code> for the label.</p></li>
<li><p><code>label_x</code>, <code>label_y</code> - to position the label inside the polygon</p></li>
<li><p><code>outerlabel_x</code>, <code>outerlabel_y</code> - to position the label outside the polygon?</p></li>
</ul></li>
<li>
<p><code><a href="reference/plot.JamPolygon.html">plot.JamPolygon()</a></code></p>
<ul><li>Wrapper to render <code>JamPolygon</code> likely using <code>grid</code> methods.</li>
</ul></li>
<li>
<p><code>print.JamPolygon()</code>, <code>summary.JamPolygon()</code></p>
<ul><li>summary function to print contents, probably using <code>print.data.frame</code>
</li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_12feb2024">12feb2024<a class="anchor" aria-label="anchor" href="#id_12feb2024"></a></h2>
<ul><li><p>Idea: Consider reporting “overlaps not shown” using <code><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">gridExtra::grid.table()</a></code></p></li>
<li>
<p>Related: Could <code><a href="https://rdrr.io/pkg/gridExtra/man/tableGrob.html" class="external-link">gridExtra::grid.table()</a></code> be used for Venn labels?</p>
<ul><li>It would need to be rendered with <code>textGrob()</code> then replaced with <code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code>
</li>
</ul></li>
<li>
<p>Marry <code>gridtext</code> and <code>ggrepel</code> for non-overlapping labels.</p>
<ul><li>Follow: <a href="https://github.com/wilkelab/gridtext/issues/33" class="external-link uri">https://github.com/wilkelab/gridtext/issues/33</a> There is a working pull request in <code>gridtext</code>, pending changes in <code>ggrepel</code>. Just awaiting each package author approval.</li>
</ul></li>
<li>
<p><code>venndir_legendir()</code></p>
<ul><li>Consider option to display “Total” unique items as the bottom row.</li>
</ul></li>
<li>
<p>Fix issue with Venn numeric label coloring when background color is dark.</p>
<ul><li>The <code>venndir_legendir()</code> label shows light text correctly, the signed labels appear to be adjusted correctly, but the count label appears not to be adjusted correctly. Some cells are correct, others are not, suggesting this is a mismatched ordering issue. Observed with 4-way Venn, it appears only the overlap regions adjust text, not the unique-set regions.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_27nov2023">27nov2023<a class="anchor" aria-label="anchor" href="#id_27nov2023"></a></h2>
<ul><li>
<p>DONE. Urgent: Transition from “sp” and “rgeos” to <code>polyclip</code> since “rgeos” has been removed from CRAN. Ugh.</p>
<ul><li>
<p>Current status:</p>
<ul><li>Most individual functions are ported with equivalent functions provided by <code><a href="https://rdrr.io/pkg/polyclip/man/polyclip.html" class="external-link">polyclip::polyclip()</a></code>.</li>
<li>There are still edge cases with polygons having holes, nested polygons (multi-part polygons) which are not handled consistently.</li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_04oct2023">04oct2023<a class="anchor" aria-label="anchor" href="#id_04oct2023"></a></h2>
<ul><li>
<p>debug issue when LOCALE is “C” the labels are not shown, and error is generating saying <code>gridtext</code> does not recognize characters, referencing some simple unicode characters (up/down arrows, etc.)</p>
<ul><li>workaround is to change LOCALE to <code>"en_US.UTF-8"</code> with: <code>Sys.setlocale("LC_ALL", "en_US.UTF-8")</code> but unclear why it’s a problem? This workaround does not seem portable for other actual locales.</li>
</ul></li>
<li><p>Optionally display overall percentage below main count label</p></li>
</ul></div>
<div class="section level2">
<h2 id="id_21sep2023">21sep2023<a class="anchor" aria-label="anchor" href="#id_21sep2023"></a></h2>
<ul><li>
<p><code><a href="reference/venndir_legender.html">venndir_legender()</a></code></p>
<ul><li>For signed data, include direction labels, colorized properly. <code>"size"</code> <code>"direction"</code> <code>"579"</code> <code>"(↑: 123, ↓: 456)"</code>
</li>
<li>It should call <code><a href="reference/curate_venn_labels.html">curate_venn_labels()</a></code> which means it needs the arguments <code>curate_df</code>,<code>unicode</code> to allow customization.</li>
</ul></li>
<li>
<p>DONE. Migrate from “sp” to <code>polyclip</code></p>
<ul><li><p>“sp” is being retired October 2023. Decided not to use <code>sf</code> due to heavy dependencies focused on geographical map software libraries which are not relevant here.</p></li>
<li><p><code>polyclip</code> provides the basic manipulations required: intersect, union, subtract, rotate, buffer.</p></li>
<li>
<p>Does <code>venndir</code> need to accept past object formats with “sp” objects?</p>
<ul><li>Migration function to convert old “sp” to new <code>polyclip</code> object.</li>
</ul></li>
<li><p>Replace <code>venn_spdf</code> with <code>data.frame</code> equivalent format.</p></li>
<li>
<p>Functions to port:</p>
<ul><li>
<code>find_vennpoly_overlaps()</code> - input <code>SpatialPolygons</code>, output <code>SpatialDataFrame</code>
</li>
<li>
<code>eulerr2polys()</code> - output <code>SpatialPolygons</code>
</li>
<li>
<code>intersect_polygons()</code> - input/output <code>SpatialPolygons</code>
</li>
<li>
<code>union_polygons()</code> - input/output <code>SpatialPolygons</code>
</li>
<li>
<code>get_largest_polygon()</code> - input/output <code>SpatialPolygons</code>
</li>
<li>
<code>sp_circles()</code>,<code>sp_ellipses()</code> - output <code>SpatialPolygons</code>
</li>
<li>
<code>nudge_sp()</code> - input/output <code>SpatialPolygons</code>
</li>
<li>
<code>rescale_sp()</code>,<code>rescale_ps()</code>,<code>rescale_p()</code>,<code><a href="reference/rescale_coordinates.html">rescale_coordinates()</a></code> - ?</li>
<li><code>polygon_label_segment()</code></li>
<li><code>sp_polylabelr()</code></li>
<li><code>sp_percent_area()</code></li>
<li><code>get_sp_buffer()</code></li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_07jul2023">07jul2023<a class="anchor" aria-label="anchor" href="#id_07jul2023"></a></h2>
<ul><li>
<p><code><a href="reference/render_venndir.html">render_venndir()</a></code></p>
<ul><li>
<p>label positioning</p>
<ul><li>Count label placement should center the main counts at the target location, with signed counts offset to the right side.</li>
<li>When main label and count label are shown together, the x-center position should be the center of the combined set label, main count label.</li>
<li>The main goal is to have the main count positioned as well inside and centered within the Venn polygon as possible. The signed counts should be considered embellishments to the main count label, so they can be slightly outside the polygon as long as they are anchored to the main counts.</li>
<li>Currently, the whole label is centered in the polygon, which sometimes makes the main count label appear on the border between two polygons.</li>
<li>When set label and counts are shown together, consider placing the main label centered at the top, count label on the left, signed labels on the right, such that the signed labels are positioned at the middle relative to the count label on the left.</li>
</ul></li>
<li><p>Consider option to display percentage beside counts for each section, as seen in several other Venn diagram tools. It’s probably too much to include percentages with the signed counts.</p></li>
<li><p>Consider using <code>grid</code> coordinates for more rendering, specifically so labels might be positioned relative to other objects, seen when resizing a graphical window. Probably not a use case worth “solving” now that I write it out.</p></li>
<li><p>Line segments should more reliably point to “just inside” the polygon shape, where the overlap is more or less a fixed amount, and slightly more than the current defaults. Currently the line mostly points to the border, it’s hard to see that the line ends just inside.</p></li>
</ul></li>
<li>
<p>Consider new function <code>reposition_venn_gridtext_labels()</code></p>
<ul><li>based upon <code>draw_gridtext_groups()</code>
</li>
<li>Purpose would be to adjust label positions after grobs are defined, so the actual height/width is defined, but before rendering.</li>
<li>Currently there is a bug, when <code>group_labels=TRUE</code> for labels outside, the whole group of labels is adjusted to right/left side of the connecting line segment. When <code>group_labels=FALSE</code> this step does not occur.</li>
<li>This function should allow re-positioning labels within a label group, such as having the title at top-center, with count labels in one or two columns beneath it, properly aligned among themselves below the title.</li>
<li>This function could also therefore enable themes, with different types of layouts. Some themes could represent the style of popular Venn diagram packages, to facilitate using alongside those packages.</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_09may2023">09may2023<a class="anchor" aria-label="anchor" href="#id_09may2023"></a></h2>
<ul><li>
<p><code><a href="reference/venndir.html">venndir()</a></code> and <code><a href="reference/render_venndir.html">render_venndir()</a></code></p>
<ul><li>DONE: option to hide border around polygons/circles; or adjust line width</li>
</ul></li>
<li>
<p>Debug rare issue with incorrect text spacing within labels in Venn diagrams?</p>
<ul><li>appears to be some rare <code>grid</code> state where signed labels have too much visible spacing between arrows and numbers, for example <code>"^^: 12"</code> appears like <code>"^^:          12"</code> for most labels, but not all.</li>
<li>a fresh R session seems to resolve the problem. Using the same R object in another new R session, the venndir output is rendered normally.</li>
<li>
<code><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.new()</a></code> does not resolve the problem in the new plot window.</li>
<li>the effect is exagerrated with <code>unicode=TRUE</code>, and diminished but still present with <code>unicode=FALSE</code>. Whitespace is still much wider than normal.</li>
</ul></li>
<li>
<p>Debug issue when <code>group_labels=FALSE</code>.</p>
<ul><li>The main set labels are no longer positioned to left or right of the incoming segment, they are positioned over center of the segment endpoint. This code might be errantly inside a conditional block.</li>
</ul></li>
<li><p>consider “normalizing” proportional polygon coordinates so the <code>x,y</code> ranges are roughly consistent with those used by fixed 3-way and 4-way Venns. Potential benefit with other functions that may use absolute or relative sizes for things like <code>segment_buffer</code> and <code>item_buffer</code>.</p></li>
<li>
<p>consider <code>venndir_output</code> object class?</p>
<ul><li><p>could be useful for re-use and editing</p></li>
<li>
<p>suggested slotNames</p>
<ul><li>
<p><code>venn_spdf</code>: soon to be using <code>sf</code> in form of <code>data.frame</code></p>
<ul><li>contains polygons for each main set (<code>spdf</code> will change to <code>sf</code>)</li>
<li>polygons for each individual Venn overlap</li>
<li>colors and alpha transparency assigned to main sets</li>
<li>
<code>x_label,y_label</code> coordinates of label inside each polygon center, however not used? the <code>label_df[,c("x","y")]</code> are slightly different.</li>
</ul></li>
<li>
<p><code>label_df</code>: <code>data.frame</code></p>
<ul><li>contains label information to be rendered: <code>text</code>, <code>venn_counts</code>, <code>overlap_set</code>, <code>type</code>
</li>
<li>
<code>x,y</code> coordinates of polygon center</li>
<li>
<code>x_offset,y_offset</code> to position label outside relative to <code>x,y</code>
</li>
<li>
<code>segment_buffer</code> used for segment depth into polygon</li>
<li>label positioning inside/outside; vjust/hjust/halign; padding</li>
<li>optionally contains items in each overlap</li>
<li>optional: <code>show_items</code>, <code>items</code>, <code>item_cex</code>, <code>item_degrees</code>
</li>
</ul></li>
<li><p><code>rv_label_df</code>: (optional?) adjusted <code>data.frame</code> from <code><a href="reference/render_venndir.html">render_venndir()</a></code></p></li>
<li><p><code>setlist</code>: new <code>list</code> representing the input data, for convenience</p></li>
</ul></li>
</ul></li>
<li><p>consider text output from <code><a href="reference/venndir_legender.html">venndir_legender()</a></code> for use by <code><a href="reference/textvenn.html">textvenn()</a></code></p></li>
<li>
<p>need convenient method to adjust set labels that are too wide</p>
<ul><li>
<p>current option is to edit <code>names(setlist)</code></p>
<ul><li>not convenient when using <code><a href="reference/venndir.html">venndir()</a></code> as a one-liner</li>
<li>in theory only the display should be affected, not actual names</li>
<li>the returned object names would also be affected</li>
</ul></li>
<li>
<p>option to “alias” the sets</p>
<ul><li>use something like A, B, C</li>
<li>DONE: show both the alias and full name in <code><a href="reference/venndir_legender.html">venndir_legender()</a></code> legend</li>
</ul></li>
<li>
<p>option to adjust labels on the fly</p>
<ul><li><p>custom adjustment function, rather than editing upfront in <code>setlist</code></p></li>
<li>
<p>could provide a few common adjustment functions</p>
<ul><li>word wrap: when label is too wide, it imposes word wrapping of whitespace</li>
<li>shortener: when label is too wide, it crops and makes labels unique</li>
<li>aliaser: assigns single values from <code>LETTERS</code> or <code><a href="https://jmw86069.github.io/jamba/reference/colNum2excelName.html" class="external-link">jamba::colNum2excelName()</a></code>
</li>
</ul></li>
</ul></li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_02may2023">02may2023<a class="anchor" aria-label="anchor" href="#id_02may2023"></a></h2>
<ul><li>
<p>Overall: replace use of “sp” (SpatialPolygons) with <code>sf</code> (Simple Features)</p>
<ul><li><p>requires changing <code>venn_spdf</code> into the <code>sf</code> equivalent, which could be nearly drop-in replacement. The <code>sf</code> default object is based upon <code>data.frame</code> already.</p></li>
<li><p>requires converting sp-specific functions: <code>nudge_sp()</code>, <code>rescale_ps()</code>, <code>rescale_sp()</code>, <code>rescale_p()</code>, <code><a href="reference/rescale_coordinates.html">rescale_coordinates()</a></code>, <code>get_sp_buffer()</code>. Some functions like <code>get_sp_buffer()</code> may be built-in with <code>sf</code>.</p></li>
<li><p>remove dependencies “sp” and “rgeos”.</p></li>
<li>
<p>replace “rgeos” functions with with built-in <code>sf</code> equivalents:</p>
<ul><li>“rgeos” <code>gArea()</code> -&gt; <code><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">sf::st_area()</a></code>
</li>
<li>“rgeos” <code>gDifference()</code> -&gt; <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">sf::st_difference()</a></code>
</li>
<li>“rgeos” <code>gBuffer()</code> -&gt; <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_buffer()</a></code>
</li>
<li>“rgeos” <code>gIntersects()</code> -&gt; <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">sf::st_intersects()</a></code>
</li>
<li>“rgeos” <code>gSimplify()</code> -&gt; <code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">sf::st_simplify()</a></code>
</li>
<li>“rgeos” <code>gUnaryUnion()</code> -&gt; <code>sf::st_union(x)</code>
</li>
<li>“rgeos” <code>gContains()</code> -&gt; <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">sf::st_contains()</a></code>
</li>
<li>“rgeos” <code>gUnion()</code> -&gt; <code>sf::st_union(x, y)</code>
</li>
</ul></li>
</ul></li>
<li>
<p><code><a href="reference/venndir.html">venndir()</a></code></p>
<ul><li>accept incidence matrix input, by calling <code><a href="reference/im_value2list.html">im_value2list()</a></code>
</li>
<li>properly convert newline <code>"\n"</code> characters to <code>&lt;br&gt;</code> internally, without having to encode this code at input.</li>
<li>properly detect when input data is not signed, to change <code>overlap_type="overlap"</code> and suppress the display of directional arrows.</li>
<li>consider calling <code>venndir_legend()</code>, perhaps as an option.</li>
</ul></li>
<li>
<p><code><a href="reference/venn_meme.html">venn_meme()</a></code></p>
<ul><li>Examples for <code>venn_meme(wtah, proportional=TRUE)</code> causes an error in <code>polygon_label_fill()</code> potentiallly trying to fill labels into a polygon overlap that does not exist in the object. It previously skipped those sections, however an error is thrown.</li>
<li>Consider renaming as <code>venndir_meme()</code>
</li>
</ul></li>
<li>
<p>For fun, consider renaming functions similar to <code><a href="reference/render_venndir.html">render_venndir()</a></code>. Some ideas:</p>
<ul><li>DONE: <code>venndir_legend()</code> -&gt; <code><a href="reference/venndir_legender.html">venndir_legender()</a></code>?</li>
<li>
<code>find_vennpoly_overlaps()</code> -&gt; <code>venndir_descender()</code>, it descends the polygon overlap combinations.</li>
<li>
<code>get_venn_shapes()</code> -&gt; <code>venndir_attender()</code>
</li>
<li>
<code><a href="reference/curate_venn_labels.html">curate_venn_labels()</a></code> -&gt; <code>venndir_amender()</code>
</li>
<li>
<code><a href="reference/make_venn_test.html">make_venn_test()</a></code> -&gt; <code>venndir_extender()</code> (not sure this one is valid)</li>
<li>
<code><a href="reference/nudge_venndir_label.html">nudge_venndir_label()</a></code> -&gt; <code>venndir_bender()</code> - general purpose function to adjust, rotate, re-position the polygons and labels. Alternate ideas: <code>venndir_mender()</code>, <code>venndir_blender()</code>
</li>
<li>
<code><a href="reference/make_venn_combn_df.html">make_venn_combn_df()</a></code> -&gt; <code>venndir_blender()</code> since it combines the Venn sets into expected combinations of overlaps; or <code>venndir_sender()</code> since the function takes set names, “sends” them out to create a set of Venn overlap combinations.</li>
<li>
<code>venndir_sender()</code> new function to return setlist for <code><a href="reference/venndir.html">venndir()</a></code> output</li>
</ul></li>
</ul></div>
<div class="section level2">
<h2 id="id_01may2023">01may2023<a class="anchor" aria-label="anchor" href="#id_01may2023"></a></h2>
<ul><li><p>check build issues on R-4.2.3, dependency on <code>data.table</code></p></li>
<li>
<p>DONE: Add venndir legend, a simple list with the number of elements in each set.</p>
<ul><li>NOT YET: automate the legend for <code><a href="reference/venndir.html">venndir()</a></code> and <code><a href="reference/render_venndir.html">render_venndir()</a></code>
</li>
<li>NOT YET: optional breakdown by sign?</li>
<li>DONE: consider something like <code>grid.table()</code>, <code>grid::tableGrob()</code>; if that implementation is too slow, see custom <code>grid.ftable()</code> described here: <a href="https://cran.r-project.org/web/packages/gridExtra/vignettes/tableGrob.html" class="external-link uri">https://cran.r-project.org/web/packages/gridExtra/vignettes/tableGrob.html</a>
</li>
</ul></li>
<li>
<p>Add optional percentage to the Venn overlap counts.</p>
<ul><li>calculation appears to use the overall percentage items.</li>
<li>The default layout would place percentage velow the main counts:</li>
</ul></li>
</ul><table style="width:69%;" class="table"><colgroup><col width="29%"><col width="40%"></colgroup><thead><tr class="header"><th colspan="2" align="right"><div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>  set_name, overlap_name, or blank</span></code></pre></div></th>
</tr></thead><tbody><tr class="odd"><td align="right">overlap_count</td>
<td rowspan="2" align="left">
<p>^: up_counts</p>
<p>v: down_counts</p>
</td>
</tr><tr class="even"><td align="right">[overlap_percent%]</td>
</tr></tbody></table><ul><li>
<p>Consider organizing labels using template styling, with commony used presets</p>
<ul><li>See above for one example.</li>
</ul></li>
<li><p>When showing items, and there are more than <code>max_items</code>, use the appropriate label instead of only showing the overlap counts. Honor the argument <code>overlap_type</code> as if items were not enabled for this region.</p></li>
<li><p>consider using equivalent <code>data.table</code> implementation for <code><a href="reference/list2im_value.html">list2im_value()</a></code>, but only if this step appears to be too slow for routine use.</p></li>
<li><p>Migrate previous items that are still active from <code>venndir_todo.md</code>.</p></li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

